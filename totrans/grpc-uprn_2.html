<html><head></head><body><section data-pdf-bookmark="Chapter 2. Getting Started with gRPC" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_02">&#13;
<h1><span class="label">Chapter 2. </span>Getting Started with gRPC</h1>&#13;
&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-type="indexterm" id="ix_ch02-asciidoc0"/>Enough with the theory on gRPC; let’s apply what you learned in <a data-type="xref" href="ch01.html#grpc_ch_01">Chapter 1</a> to build a real-world gRPC application from the ground up. In this chapter, you will use both Go and Java to build a simple gRPC service and a client application that invokes the service you developed. In the process you’ll learn about specifying a gRPC service definition using protocol buffers, generating a server skeleton and client stub, implementing a service’s business logic, running a gRPC server with the service you implemented, and invoking the service through the gRPC client application.</p>&#13;
&#13;
<p>Let’s use the same online retail system from <a data-type="xref" href="ch01.html#grpc_ch_01">Chapter 1</a>, where we need to build a service that is responsible for managing the products of a retail store. The service can be remotely accessed and the consumers of that service can add new products to the system and also retrieve product details from the system by providing the product ID. We’ll model this service and consumer using gRPC. You may pick the programming language of your choice to implement this, but in this chapter, we will use both the Go and Java languages to implement this sample.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>You can try out both the Go and Java implementations of the sample in the source code repository for this book.</p>&#13;
</div>&#13;
&#13;
<p>In <a data-type="xref" href="#client_server_interaction_of_product_info_service">Figure 2-1</a>, we illustrate the client–server communication patterns of the <code>ProductInfo</code> service&#13;
for each method invocation. The server hosts a gRPC service that offers two remote methods: <code>addProduct(product)</code> and <code>getProduct(productId)</code>. The client can invoke either of those remote methods.</p>&#13;
&#13;
<figure><div class="figure" id="client_server_interaction_of_product_info_service">&#13;
<img alt="client-server interaction of Product Info service" src="assets/grpc_0201.png"/>&#13;
<h6><span class="label">Figure 2-1. </span>Client–server interaction of ProductInfo service</h6>&#13;
</div></figure>&#13;
&#13;
<p>Let’s start building this sample by creating the service definition of the <code>ProductInfo</code> gRPC service.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating the Service Definition" data-type="sect1"><div class="sect1" id="idm46536647136680">&#13;
<h1>Creating the Service Definition</h1>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="service definition" data-type="indexterm" id="ix_ch02-asciidoc1"/><a data-primary="service definition" data-secondary="for online retail system application" data-type="indexterm" id="ix_ch02-asciidoc2"/>As you learned in <a data-type="xref" href="ch01.html#grpc_ch_01">Chapter 1</a>, when you develop a gRPC application, the first thing you do is define the service interface, which contains the methods that allow consumers to call remotely, the method parameters and message formats to use when invoking those methods, and so on. <a data-primary="IDL (interface definition language)" data-type="indexterm" id="idm46536647131544"/><a data-primary="interface definition language (IDL)" data-type="indexterm" id="idm46536647130856"/>All these service definitions are recorded as a <a href="https://oreil.ly/1X5Ws">protocol buffer’s definition</a>, which is the interface definition language (IDL) used in gRPC.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>We will further dive into service definition techniques for different messaging patterns in <a data-type="xref" href="ch03.html#ch_03">Chapter 3</a>. We will also cover the details of protocol buffers and gRPC implementation details in <a data-type="xref" href="ch04.html#ch_04">Chapter 4</a>.</p>&#13;
</div>&#13;
&#13;
<p>Once you identify the business capabilities of the service, you can define the service interface to fulfill the business need. In our sample, we can identify two remote methods (<code>addProduct(product)</code> and <code>getProduct(productId)</code>) in the <code>ProductInfo</code> service and two message types (<code>Product</code> and <code>ProductID</code>) that both methods accept and return.</p>&#13;
&#13;
<p>The next step is to specify these service definitions as a protocol buffer definition. With protocol buffers, we can define services and message types. A service consists of its methods and each method is defined by its type, input, and output parameters. The message consists of its fields and each field is defined by its type and a unique index value. Let’s dive into the details of defining message structures.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Defining Messages" data-type="sect2"><div class="sect2" id="idm46536647122552">&#13;
<h2>Defining Messages</h2>&#13;
&#13;
<p><a data-primary="message" data-secondary="defining" data-type="indexterm" id="idm46536647120984"/><a data-primary="service definition" data-secondary="defining messages" data-type="indexterm" id="idm46536647119784"/>The <em>message</em> is the data structure that is exchanged between client and service. As you can see in <a data-type="xref" href="#client_server_interaction_of_product_info_service">Figure 2-1</a>, our <code>ProductInfo</code> use case has two message types. One is the product information (<code>Product</code>), which is required when adding a new product to the system and is returned when retrieving a particular product. The other is a unique identification (<code>ProductID</code>) of the product, which is required when retrieving a particular product from the system and is returned when adding a new product:</p>&#13;
<dl>&#13;
<dt><code>ProductID</code></dt>&#13;
<dd>&#13;
<p><code>ProductID</code> is a unique identifier of the product that can be a string value. We can either define our own message type that contains a string field or use the well-known message type <code>google.protobuf.StringValue</code>, provided by the protocol buffer library. In this example, we are going to define our own message type that contains a string field. The <code>ProductID</code> message type definition is shown in <a data-type="xref" href="#EX2-1a">Example 2-1</a>.</p>&#13;
</dd>&#13;
</dl>&#13;
<div data-type="example" id="EX2-1a">&#13;
<h5><span class="label">Example 2-1. </span>Protocol Buffer definition of ProductID message type.</h5>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="kd">message</code> <code class="nc">ProductID</code> <code class="p">{</code>&#13;
   <code class="kt">string</code> <code class="na">value</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>&#13;
<code class="p">}</code></pre></div>&#13;
<dl>&#13;
<dt><code>Product</code></dt>&#13;
<dd>&#13;
<p><code>Product</code> is a custom message type that represents the data that should exist in a product in our online retail application. It can have a set of fields that represent the data associated with each product.  Suppose the <code>Product</code> message type has the following fields:</p>&#13;
<dl>&#13;
<dt><code>ID</code></dt>&#13;
<dd>&#13;
<p>Unique identifier of the product</p>&#13;
</dd>&#13;
<dt><code>Name</code></dt>&#13;
<dd>&#13;
<p>Product name</p>&#13;
</dd>&#13;
<dt><code>Description</code></dt>&#13;
<dd>&#13;
<p>Product description</p>&#13;
</dd>&#13;
<dt><code>Price</code></dt>&#13;
<dd>&#13;
<p>Product price</p>&#13;
</dd>&#13;
</dl>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>Then we can define our custom message type using a protocol buffer as shown in <a data-type="xref" href="#EX2-1">Example 2-2</a>.</p>&#13;
<div data-type="example" id="EX2-1">&#13;
<h5><span class="label">Example 2-2. </span>Protocol buffer definition of Product message type</h5>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="kd">message</code> <code class="nc">Product</code> <code class="p">{</code>&#13;
   <code class="kt">string</code> <code class="na">id</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>&#13;
   <code class="kt">string</code> <code class="na">name</code> <code class="o">=</code> <code class="mi">2</code><code class="p">;</code>&#13;
   <code class="kt">string</code> <code class="na">description</code> <code class="o">=</code> <code class="mi">3</code><code class="p">;</code>&#13;
   <code class="kt">float</code> <code class="na">price</code> <code class="o">=</code> <code class="mi">4</code><code class="p">;</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>Here the number assigned to each message field is used to uniquely identify the field in the message. So, we can’t use the same number in two different fields in the same message definition. We will further dive into the details of the message definition techniques of protocol buffers and explain why we need to provide a unique number for each field in <a data-type="xref" href="ch04.html#ch_04">Chapter 4</a>. For now, you can think of it as a rule when defining a protocol buffer message.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="protobuf library" data-type="indexterm" id="idm46536647036136"/>The protobuf library provides a set of protobuf message types for well-known types. So we can reuse them instead of defining such types again in our service definition. You can get more details about these well-known types in the <a href="https://oreil.ly/D8Ysn">protocol buffers documentation</a>.</p>&#13;
</div>&#13;
&#13;
<p>Since we have completed defining message types for the <code>ProductInfo</code> service, we can move on to the service interface definition.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Defining Services" data-type="sect2"><div class="sect2" id="idm46536647121896">&#13;
<h2>Defining Services</h2>&#13;
&#13;
<p><a data-primary="service" data-secondary="defining" data-type="indexterm" id="ix_ch02-asciidoc3"/><a data-primary="service definition" data-secondary="defining services" data-type="indexterm" id="ix_ch02-asciidoc4"/>A <em>service</em> is a collection of remote methods that are exposed to a client. In our sample, the <code>ProductInfo</code> service has two remote methods: <code>addProduct(product)</code> and <code>getProduct(productId)</code>. According to the protocol buffer rule, we can only have one input parameter in a remote method and it can return only one value. If we need to pass multiple values to the method like in the <code>addProduct</code> method, we need to define a message type and group all the values as we have done in the <code>Product</code> message type:</p>&#13;
<dl>&#13;
<dt><code>addProduct</code></dt>&#13;
<dd>&#13;
<p>Creates a new <code>Product</code> in the system. It requires the details of the product as input and returns the product identification number of the newly added product, if the action completed successfully. <a data-type="xref" href="#EX2-2">Example 2-3</a> shows the definition of the <code>addProduct</code> method.</p>&#13;
</dd>&#13;
</dl>&#13;
<div data-type="example" id="EX2-2">&#13;
<h5><span class="label">Example 2-3. </span>Protocol buffer definition of <em>addProduct</em> method</h5>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="k">rpc</code> <code class="n">addProduct</code><code class="p">(</code><code class="n">Product</code><code class="p">)</code> <code class="k">returns</code> <code class="p">(</code><code class="n">google.protobuf.StringValue</code><code class="p">);</code></pre></div>&#13;
<dl>&#13;
<dt><code>getProduct</code></dt>&#13;
<dd>&#13;
<p>Retrieves product information. It requires the <code>ProductID</code> as input and returns <code>Product</code> details if a particular product exists in the system. <a data-type="xref" href="#EX2-3">Example 2-4</a> shows the definition of the <code>getProduct</code> method.</p>&#13;
</dd>&#13;
</dl>&#13;
<div data-type="example" id="EX2-3">&#13;
<h5><span class="label">Example 2-4. </span>Protocol buffer definition of <em>getProduct</em> method</h5>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="k">rpc</code> <code class="n">getProduct</code><code class="p">(</code><code class="n">google.protobuf.StringValue</code><code class="p">)</code> <code class="k">returns</code> <code class="p">(</code><code class="n">Product</code><code class="p">);</code></pre></div>&#13;
&#13;
<p>Combining all messages and services, we now have a complete protocol buffer definition for our <code>ProductInfo</code> use case, as shown in <a data-type="xref" href="#EX2-4">Example 2-5</a>.</p>&#13;
<div data-type="example" id="EX2-4">&#13;
<h5><span class="label">Example 2-5. </span>gRPC service definition of ProductInfo service using protocol buffers</h5>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="na">syntax</code><code> </code><code class="o">=</code><code> </code><code class="s">"proto3"</code><code class="p">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-1" id="co_getting_started_with_grpc_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="kn">package</code><code> </code><code class="nn">ecommerce</code><code class="p">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-2" id="co_getting_started_with_grpc_CO1-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="kd">service</code><code> </code><code class="n">ProductInfo</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-3" id="co_getting_started_with_grpc_CO1-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="k">rpc</code><code> </code><code class="n">addProduct</code><code class="p">(</code><code class="n">Product</code><code class="p">)</code><code> </code><code class="k">returns</code><code> </code><code class="p">(</code><code class="n">ProductID</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-4" id="co_getting_started_with_grpc_CO1-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="k">rpc</code><code> </code><code class="n">getProduct</code><code class="p">(</code><code class="n">ProductID</code><code class="p">)</code><code> </code><code class="k">returns</code><code> </code><code class="p">(</code><code class="n">Product</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-5" id="co_getting_started_with_grpc_CO1-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code class="p">}</code><code>&#13;
</code><code>&#13;
</code><code class="kd">message</code><code> </code><code class="nc">Product</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-6" id="co_getting_started_with_grpc_CO1-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>    </code><code class="kt">string</code><code> </code><code class="na">id</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code class="p">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-7" id="co_getting_started_with_grpc_CO1-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code>    </code><code class="kt">string</code><code> </code><code class="na">name</code><code> </code><code class="o">=</code><code> </code><code class="mi">2</code><code class="p">;</code><code>&#13;
</code><code>    </code><code class="kt">string</code><code> </code><code class="na">description</code><code> </code><code class="o">=</code><code> </code><code class="mi">3</code><code class="p">;</code><code>&#13;
</code><code class="p">}</code><code>&#13;
</code><code>&#13;
</code><code class="kd">message</code><code> </code><code class="nc">ProductID</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO1-8" id="co_getting_started_with_grpc_CO1-8"><img alt="8" src="assets/8.png"/></a><code>&#13;
</code><code>    </code><code class="kt">string</code><code> </code><code class="na">value</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code class="p">;</code><code>&#13;
</code><code class="p">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-1" id="callout_getting_started_with_grpc_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>The service definition begins with specifying the protocol buffer version (proto3) that we use.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-2" id="callout_getting_started_with_grpc_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Package names are used to prevent name clashes between protocol message types and also will be used to generate code.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-3" id="callout_getting_started_with_grpc_CO1-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Definition of the service interface of the service.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-4" id="callout_getting_started_with_grpc_CO1-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Remote method to add a product that returns the product ID as the response.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-5" id="callout_getting_started_with_grpc_CO1-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Remote method to get a product based on the product ID.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-6" id="callout_getting_started_with_grpc_CO1-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Definition of the message format/type of <code>Product</code>.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-7" id="callout_getting_started_with_grpc_CO1-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>Field (name-value pair) that holds the product ID with unique field numbers that are used to identify your fields in the message binary format.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO1-8" id="callout_getting_started_with_grpc_CO1-8"><img alt="8" src="assets/8.png"/></a></dt>&#13;
<dd><p>Definition of the message format/type of ProductID.</p></dd>&#13;
</dl>&#13;
&#13;
<p>In the protocol buffer definition, we can specify a package name (e.g., <code>ecommerce</code>), which helps to prevent naming conflicts between different projects. When we generate code for our services or clients using this service definition with a package, the same packages (unless we explicitly specify a different package for code generation) are created in the respective programming language (of course only if the language supports the notion of a <em>package</em>) with which our code is generated. We can also define package names with version numbers like <code>ecommerce.v1</code> and <code>ecommerce.v2</code>. So future major changes to the API can coexist in the same codebase.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="integrated development environments (IDEs)" data-type="indexterm" id="idm46536646758200"/>Commonly used IDEs (integrated development environments) such as IntelliJ IDEA, Eclipse, VSCode, etc., now have plug-ins to support protocol buffers. You can install the plug-in to your IDE and easily create a protocol buffer definition for your service.</p>&#13;
</div>&#13;
&#13;
<p>One other process that should be mentioned here is importing from another proto file. If we need to use the message types defined in other proto files, we can import them and our protocol buffer definition. For example, if we want to use the <code>StringValue</code> type (<code>google.protobuf.StringValue</code>) defined in the <em>wrappers.proto</em> file, we can import the <em>google/protobuf/wrappers.proto</em> file in our definition as follows:</p>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="na">syntax</code> <code class="o">=</code> <code class="s">"proto3"</code><code class="p">;</code>&#13;
&#13;
<code class="k">import</code> <code class="s">"google/protobuf/wrappers.proto"</code><code class="p">;</code>&#13;
&#13;
<code class="kn">package</code> <code class="nn">ecommerce</code><code class="p">;</code>&#13;
<code class="o">...</code></pre>&#13;
&#13;
<p>Once you complete the specification of the service definition, you can proceed to the implementation of the gRPC service and the client<a data-startref="ix_ch02-asciidoc4" data-type="indexterm" id="idm46536646747080"/><a data-startref="ix_ch02-asciidoc3" data-type="indexterm" id="idm46536646746472"/>.<a data-startref="ix_ch02-asciidoc2" data-type="indexterm" id="idm46536646745736"/><a data-startref="ix_ch02-asciidoc1" data-type="indexterm" id="idm46536646745032"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementation" data-type="sect1"><div class="sect1" id="idm46536647032824">&#13;
<h1>Implementation</h1>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="implementation" data-type="indexterm" id="ix_ch02-asciidoc5"/><a data-primary="implementation" data-secondary="online retail system application" data-type="indexterm" id="ix_ch02-asciidoc6"/>Let’s implement a gRPC service with the set of remote methods that we specified in the service definition. These remote methods are exposed by the server and the gRPC client connects to the server and invokes those remote methods.</p>&#13;
&#13;
<p>As illustrated in <a data-type="xref" href="#a_microservice_and_a_consumer_based_on_service_definition">Figure 2-2</a>, we first need to compile the <code>ProductInfo</code> service definition and generate source code for the chosen language. Out of the box, gRPC is <span class="keep-together">supported</span> by all the popular languages like Java, Go, Python, Ruby, C, C++, Node, etc. You can choose which language to use when implementing the service or client. gRPC also works across multiple languages and platforms, which means you can have your server written in one language and your client written in another language in your application. In our sample, we will develop our client and server in both the Go and Java languages, so you can follow whichever implementation you prefer to use.</p>&#13;
&#13;
<p>In order to generate source code from the service definition, we can either manually compile the proto file using the <a href="https://oreil.ly/CYEbY">protocol buffer compiler</a> or we can use build automation tools like Bazel, Maven, or Gradle. Those automation tools already have a set of rules defined to generate the code when building the project. Often it is easier to integrate with an existing build tool to generate the source code of the gRPC service and client.</p>&#13;
&#13;
<figure><div class="figure" id="a_microservice_and_a_consumer_based_on_service_definition">&#13;
<img alt="client-server interaction of Product Info service" src="assets/grpc_0202.png"/>&#13;
<h6><span class="label">Figure 2-2. </span>A microservice and a consumer based on a service definition</h6>&#13;
</div></figure>&#13;
&#13;
<p>In this sample, we’ll use Gradle to build the Java application and use the Gradle protocol buffer plug-in to generate the service and client code. For the Go application, we’ll use the protocol buffer compiler and generate the code.</p>&#13;
&#13;
<p>Let’s walk through implementing a gRPC server and client in Go and Java. Before we do this, make sure you have installed Java 7 or higher and Go 1.11 or higher on your local machine.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Developing a Service" data-type="sect2"><div class="sect2" id="idm46536646727656">&#13;
<h2>Developing a Service</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="developing a service" data-type="indexterm" id="ix_ch02-asciidoc7"/><a data-primary="service" data-secondary="developing" data-type="indexterm" id="ix_ch02-asciidoc8"/>When you generate the service skeleton code, you will get the low-level code required to establish the gRPC communication, relevant message types, and interfaces. The task of service implementation is all about implementing the interfaces that are generated with the code generation step. Let’s start with implementing the Go service and then we will look at how to implement the same service in the Java language.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing a gRPC service with Go" data-type="sect3"><div class="sect3" id="idm46536646723336">&#13;
<h3>Implementing a gRPC service with Go</h3>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="implementing a gRPC service with Go" data-type="indexterm" id="ix_ch02-asciidoc9"/><a data-primary="Go" data-secondary="implementing a gRPC service with" data-type="indexterm" id="ix_ch02-asciidoc10"/><a data-primary="service" data-secondary="implementing with Go" data-type="indexterm" id="ix_ch02-asciidoc11"/>Implementing the Go service has three steps. First, we need to generate the stubs for the service definition, then we implement the business logic of all the remote methods of the service, and finally, we create a server listening on a specified port and register the service to accept client requests.&#13;
Let’s start by creating a new Go module. Here we are going to create one module and a subdirectory inside the module; the module <code>productinfo/service</code> is used to keep the service code and the subdirectory (<code>ecommerce</code>) is used to keep the autogenerated stub file. Create a directory inside the <em>productinfo</em> directory and call it <em>service</em>. Navigate inside to the <em>service</em> directory and execute the following command to create the module <code>productinfo/service</code>:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">go mod init productinfo/service</pre>&#13;
&#13;
<p>Once you create the module and create a subdirectory inside the module, you will get a module structure as follows:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">└─ productinfo&#13;
           └─ service&#13;
                 ├── go.mod&#13;
                 ├ . . .&#13;
                 └── ecommerce&#13;
                         └── . . .</pre>&#13;
&#13;
<p>We also need to update the <em>go.mod</em> file with the dependencies with the specific version as shown in the following:</p>&#13;
&#13;
<pre data-code-language="proto" data-type="programlisting"><code class="n">module</code> <code class="n">productinfo</code><code class="o">/</code><code class="kd">service</code>&#13;
&#13;
<code class="n">require</code> <code class="p">(</code>&#13;
  <code class="n">github.com</code><code class="o">/</code><code class="n">gofrs</code><code class="o">/</code><code class="n">uuid</code> <code class="n">v3.2.0</code>&#13;
  <code class="n">github.com</code><code class="o">/</code><code class="n">golang</code><code class="o">/</code><code class="n">protobuf</code> <code class="n">v1.3.2</code>&#13;
  <code class="n">github.com</code><code class="o">/</code><code class="n">google</code><code class="o">/</code><code class="n">uuid</code> <code class="n">v1.1.1</code>&#13;
  <code class="n">google.golang.org</code><code class="o">/</code><code class="n">grpc</code> <code class="n">v1.24.0</code>&#13;
<code class="p">)</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="Go" data-secondary="modules" data-type="indexterm" id="idm46536646620168"/><a data-primary="modules (Go concept)" data-type="indexterm" id="idm46536646619256"/>From Go 1.11 onwards, a new concept called <em>modules</em> has been introduced that allows developers to create and build Go projects outside GOPATH. To create a Go module, we need to create a new directory anywhere outside <code>$GOPATH/src</code> and inside the directory, we need to execute the command to initialize the module with a module name like the following:</p>&#13;
&#13;
<p><code>go mod init &lt;module_name&gt;</code></p>&#13;
&#13;
<p>Once you initialize the module, a <em>go.mod</em> file will be created inside the root of the module. And then we can create our Go source file inside the module and build it. Go resolves imports by using the specific dependency module versions listed in <em>go.mod</em>.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Generating client/server stubs" data-type="sect4"><div class="sect4" id="gen_client_server_stubs">&#13;
<h4>Generating client/server stubs</h4>&#13;
&#13;
<p><a data-primary="client/server stubs, generating" data-type="indexterm" id="idm46536646613192"/><a data-primary="Go" data-secondary="generating client/server stubs" data-type="indexterm" id="idm46536646612520"/>Now we’ll generate client/server stubs manually, using the protocol buffer compiler. To do that, we need to fulfill a set of prerequisites as listed here:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Download and install the latest protocol buffer version 3 compiler from the <a href="https://oreil.ly/Ez8qu">GitHub release page</a>.</p>&#13;
</li>&#13;
</ul>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>When downloading the compiler, you need to choose the compiler that suits your platform. For example, if you are using a 64-bit Linux machine and you need to get a protocol buffer compiler version x.x.x, you need to download the <em>protoc-x.x.x-linux-x86_64.zip</em> file.</p>&#13;
</div>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Install the gRPC library using the following command:</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">go get -u google.golang.org/grpc</pre>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Install the protoc plug-in for Go using the following command:</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">go get -u github.com/golang/protobuf/protoc-gen-go</pre>&#13;
&#13;
<p><a data-primary="protoc" data-type="indexterm" id="idm46536646604248"/>Once we fulfill all the prerequisites, we can generate the code for the service definition by executing the protoc command as shown here:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code>protoc</code><code> </code><code>-I</code><code> </code><code>ecommerce</code><code> </code><code class="se">\ </code><a class="co" href="#callout_getting_started_with_grpc_CO2-1" id="co_getting_started_with_grpc_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
  </code><code>ecommerce/product_info.proto</code><code> </code><code class="se">\ </code><a class="co" href="#callout_getting_started_with_grpc_CO2-2" id="co_getting_started_with_grpc_CO2-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
  </code><code>--go_out</code><code class="o">=</code><code class="nv">plugins</code><code class="o">=</code><code>grpc:</code><code>&lt;</code><code>module_dir_path&gt;/ecommerce</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO2-3" id="co_getting_started_with_grpc_CO2-3"><img alt="3" src="assets/3.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO2-1" id="callout_getting_started_with_grpc_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Specifies the directory path where the source proto file and dependent proto files exist (specified with the <code>--proto_path</code> or <code>-I</code> command-line flag). If you do not specify a value, the current directory is used as the source directory. Inside the directory, we need to arrange the dependent proto files in accordance with the package name.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO2-2" id="callout_getting_started_with_grpc_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Specifies the proto file path you want to compile. The compiler will read the file and generate the output Go file.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO2-3" id="callout_getting_started_with_grpc_CO2-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Specifies the destination directory where you want the generated code to go.</p></dd>&#13;
</dl>&#13;
&#13;
<p>When we execute the command, a stub file (<em>product_info.pb.go</em>) will be generated inside the given subdirectory (<em>ecommerce</em>) in the module. Now that we have generated the stubs, we need to implement our business logic using the generated code.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing business logic" data-type="sect4"><div class="sect4" id="idm46536646614408">&#13;
<h4>Implementing business logic</h4>&#13;
&#13;
<p><a data-primary="business logic" data-secondary="implementing with Go" data-type="indexterm" id="idm46536646481176"/><a data-primary="Go" data-secondary="implementing business logic" data-type="indexterm" id="idm46536646480264"/>First, let’s create a new Go file named <em>productinfo_service.go</em> inside the Go module (<code>productinfo/service</code>) and implement the remote methods as shown in <a data-type="xref" href="#EX2-5">Example 2-6</a>.</p>&#13;
<div data-type="example" id="EX2-5">&#13;
<h5><span class="label">Example 2-6. </span>gRPC service implementation of <em>ProductInfo</em> service in Go</h5>&#13;
&#13;
<pre data-code-language="go" data-type="programlisting"><code class="kn">package</code><code> </code><code class="nx">main</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="p">(</code><code>&#13;
</code><code>  </code><code class="s">"context"</code><code>&#13;
</code><code>  </code><code class="s">"errors"</code><code>&#13;
</code><code>  </code><code class="s">"log"</code><code>&#13;
</code><code>&#13;
</code><code class="s">"github.com/gofrs/uuid"</code><code>&#13;
</code><code class="nx">pb</code><code> </code><code class="s">"productinfo/service/ecommerce"</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO3-1" id="co_getting_started_with_grpc_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
&#13;
</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="c1">// server is used to implement ecommerce/product_info.&#13;
</code><code class="kd">type</code><code> </code><code class="nx">server</code><code> </code><code class="kd">struct</code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO3-2" id="co_getting_started_with_grpc_CO3-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
  </code><code class="nx">productMap</code><code> </code><code class="kd">map</code><code class="p">[</code><code class="kt">string</code><code class="p">]</code><code class="o">*</code><code class="nx">pb</code><code class="p">.</code><code class="nx">Product</code><code>&#13;
</code><code class="p">}</code><code>&#13;
</code><code>&#13;
</code><code class="c1">// AddProduct implements ecommerce.AddProduct&#13;
</code><code class="kd">func</code><code> </code><code class="p">(</code><code class="nx">s</code><code> </code><code class="o">*</code><code class="nx">server</code><code class="p">)</code><code> </code><code class="nx">AddProduct</code><code class="p">(</code><code class="nx">ctx</code><code> </code><code class="nx">context</code><code class="p">.</code><code class="nx">Context</code><code class="p">,</code><code>&#13;
</code><code>                    </code><code class="nx">in</code><code> </code><code class="o">*</code><code class="nx">pb</code><code class="p">.</code><code class="nx">Product</code><code class="p">)</code><code> </code><code class="p">(</code><code class="o">*</code><code class="nx">pb</code><code class="p">.</code><code class="nx">ProductID</code><code class="p">,</code><code> </code><code class="kt">error</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO3-3" id="co_getting_started_with_grpc_CO3-3"><img alt="3" src="assets/3.png"/></a><a class="co" href="#callout_getting_started_with_grpc_CO3-5" id="co_getting_started_with_grpc_CO3-4"><img alt="5" src="assets/5.png"/></a><a class="co" href="#callout_getting_started_with_grpc_CO3-6" id="co_getting_started_with_grpc_CO3-5"><img alt="6" src="assets/6.png"/></a><code>&#13;
  </code><code class="nx">out</code><code class="p">,</code><code> </code><code class="nx">err</code><code> </code><code class="o">:=</code><code> </code><code class="nx">uuid</code><code class="p">.</code><code class="nx">NewV4</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="k">if</code><code> </code><code class="nx">err</code><code> </code><code class="o">!=</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code>&#13;
</code><code>     </code><code class="k">return</code><code> </code><code class="kc">nil</code><code class="p">,</code><code> </code><code class="nx">status</code><code class="p">.</code><code class="nx">Errorf</code><code class="p">(</code><code class="nx">codes</code><code class="p">.</code><code class="nx">Internal</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="s">"Error while generating Product ID"</code><code class="p">,</code><code> </code><code class="nx">err</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="nx">in</code><code class="p">.</code><code class="nx">Id</code><code> </code><code class="p">=</code><code> </code><code class="nx">out</code><code class="p">.</code><code class="nx">String</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="k">if</code><code> </code><code class="nx">s</code><code class="p">.</code><code class="nx">productMap</code><code> </code><code class="o">==</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code>&#13;
</code><code>     </code><code class="nx">s</code><code class="p">.</code><code class="nx">productMap</code><code> </code><code class="p">=</code><code> </code><code class="nb">make</code><code class="p">(</code><code class="kd">map</code><code class="p">[</code><code class="kt">string</code><code class="p">]</code><code class="o">*</code><code class="nx">pb</code><code class="p">.</code><code class="nx">Product</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="nx">s</code><code class="p">.</code><code class="nx">productMap</code><code class="p">[</code><code class="nx">in</code><code class="p">.</code><code class="nx">Id</code><code class="p">]</code><code> </code><code class="p">=</code><code> </code><code class="nx">in</code><code>&#13;
</code><code>  </code><code class="k">return</code><code> </code><code class="o">&amp;</code><code class="nx">pb</code><code class="p">.</code><code class="nx">ProductID</code><code class="p">{</code><code class="nx">Value</code><code class="p">:</code><code> </code><code class="nx">in</code><code class="p">.</code><code class="nx">Id</code><code class="p">}</code><code class="p">,</code><code> </code><code class="nx">status</code><code class="p">.</code><code class="nx">New</code><code class="p">(</code><code class="nx">codes</code><code class="p">.</code><code class="nx">OK</code><code class="p">,</code><code> </code><code class="s">""</code><code class="p">)</code><code class="p">.</code><code class="nx">Err</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="p">}</code><code>&#13;
</code><code>&#13;
</code><code class="c1">// GetProduct implements ecommerce.GetProduct&#13;
</code><code class="kd">func</code><code> </code><code class="p">(</code><code class="nx">s</code><code> </code><code class="o">*</code><code class="nx">server</code><code class="p">)</code><code> </code><code class="nx">GetProduct</code><code class="p">(</code><code class="nx">ctx</code><code> </code><code class="nx">context</code><code class="p">.</code><code class="nx">Context</code><code class="p">,</code><code> </code><code class="nx">in</code><code> </code><code class="o">*</code><code class="nx">pb</code><code class="p">.</code><code class="nx">ProductID</code><code class="p">)</code><code>&#13;
</code><code>                              </code><code class="p">(</code><code class="o">*</code><code class="nx">pb</code><code class="p">.</code><code class="nx">Product</code><code class="p">,</code><code> </code><code class="kt">error</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO3-4" id="co_getting_started_with_grpc_CO3-6"><img alt="4" src="assets/4.png"/></a><a class="co" href="#callout_getting_started_with_grpc_CO3-5" id="co_getting_started_with_grpc_CO3-7"><img alt="5" src="assets/5.png"/></a><a class="co" href="#callout_getting_started_with_grpc_CO3-6" id="co_getting_started_with_grpc_CO3-8"><img alt="6" src="assets/6.png"/></a><code>&#13;
  </code><code class="nx">value</code><code class="p">,</code><code> </code><code class="nx">exists</code><code> </code><code class="o">:=</code><code> </code><code class="nx">s</code><code class="p">.</code><code class="nx">productMap</code><code class="p">[</code><code class="nx">in</code><code class="p">.</code><code class="nx">Value</code><code class="p">]</code><code>&#13;
</code><code>  </code><code class="k">if</code><code> </code><code class="nx">exists</code><code> </code><code class="p">{</code><code>&#13;
</code><code>    </code><code class="k">return</code><code> </code><code class="nx">value</code><code class="p">,</code><code> </code><code class="nx">status</code><code class="p">.</code><code class="nx">New</code><code class="p">(</code><code class="nx">codes</code><code class="p">.</code><code class="nx">OK</code><code class="p">,</code><code> </code><code class="s">""</code><code class="p">)</code><code class="p">.</code><code class="nx">Err</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="k">return</code><code> </code><code class="kc">nil</code><code class="p">,</code><code> </code><code class="nx">status</code><code class="p">.</code><code class="nx">Errorf</code><code class="p">(</code><code class="nx">codes</code><code class="p">.</code><code class="nx">NotFound</code><code class="p">,</code><code> </code><code class="s">"Product does not exist."</code><code class="p">,</code><code> </code><code class="nx">in</code><code class="p">.</code><code class="nx">Value</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="p">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO3-1" id="callout_getting_started_with_grpc_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Import the package that contains the generated code we just created from the protobuf compiler.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO3-2" id="callout_getting_started_with_grpc_CO3-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The <code>server</code> struct is an abstraction of the server. It allows attaching service methods to the server.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO3-3" id="callout_getting_started_with_grpc_CO3-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The <code>AddProduct</code> method takes <code>Product</code> as a parameter and returns a <code>ProductID</code>. <code>Product</code> and <code>ProductID</code> structs are defined in the <em>product_info.pb.go</em> file, which is autogenerated from the <em>product_info.proto</em> definition.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO3-6" id="callout_getting_started_with_grpc_CO3-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The <code>GetProduct</code> method takes <code>ProductID</code> as a parameter and returns a <code>Product</code>.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO3-4" id="callout_getting_started_with_grpc_CO3-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Both methods also have a <code>Context</code> parameter. A <code>Context</code> object contains metadata such as the identity of the end user authorization tokens and the request’s deadline, and it will exist during the lifetime of the request.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO3-5" id="callout_getting_started_with_grpc_CO3-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Both methods return an error in addition to the return value of the remote method (methods have multiple return types). These errors are propagated to the consumers and can be used for error handling at the consumer side.</p></dd>&#13;
</dl>&#13;
&#13;
<p>That’s all you have to do to implement the business logic of the <code>ProductInfo</code> service. Then we can create a simple server that hosts the service and accepts requests from the client.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating a Go server" data-type="sect4"><div class="sect4" id="idm46536646329496">&#13;
<h4>Creating a Go server</h4>&#13;
&#13;
<p><a data-primary="Go" data-secondary="server creation with" data-type="indexterm" id="idm46536646328056"/><a data-primary="server" data-secondary="creating with Go" data-type="indexterm" id="idm46536646429144"/>To create the server in Go, let’s create a new Go file named <em>main.go</em> inside the same Go package (<code>productinfo/service</code>) and implement the <code>main</code> method as shown in <a data-type="xref" href="#EX2-6">Example 2-7</a>.</p>&#13;
<div data-type="example" id="EX2-6">&#13;
<h5><span class="label">Example 2-7. </span>gRPC server implementation to host ProductInfo service in Go</h5>&#13;
&#13;
<pre data-code-language="go" data-type="programlisting"><code class="kn">package</code><code> </code><code class="nx">main</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="p">(</code><code>&#13;
</code><code>  </code><code class="s">"log"</code><code>&#13;
</code><code>  </code><code class="s">"net"</code><code>&#13;
</code><code>&#13;
</code><code>  </code><code class="nx">pb</code><code> </code><code class="s">"productinfo/service/ecommerce"</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO4-1" id="co_getting_started_with_grpc_CO4-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
  </code><code class="s">"google.golang.org/grpc"</code><code>&#13;
</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="kd">const</code><code> </code><code class="p">(</code><code>&#13;
</code><code>  </code><code class="nx">port</code><code> </code><code class="p">=</code><code> </code><code class="s">":50051"</code><code>&#13;
</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="kd">func</code><code> </code><code class="nx">main</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>&#13;
</code><code>  </code><code class="nx">lis</code><code class="p">,</code><code> </code><code class="nx">err</code><code> </code><code class="o">:=</code><code> </code><code class="nx">net</code><code class="p">.</code><code class="nx">Listen</code><code class="p">(</code><code class="s">"tcp"</code><code class="p">,</code><code> </code><code class="nx">port</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO4-2" id="co_getting_started_with_grpc_CO4-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
  </code><code class="k">if</code><code> </code><code class="nx">err</code><code> </code><code class="o">!=</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code>&#13;
</code><code>     </code><code class="nx">log</code><code class="p">.</code><code class="nx">Fatalf</code><code class="p">(</code><code class="s">"failed to listen: %v"</code><code class="p">,</code><code> </code><code class="nx">err</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="nx">s</code><code> </code><code class="o">:=</code><code> </code><code class="nx">grpc</code><code class="p">.</code><code class="nx">NewServer</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO4-3" id="co_getting_started_with_grpc_CO4-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
  </code><code class="nx">pb</code><code class="p">.</code><code class="nx">RegisterProductInfoServer</code><code class="p">(</code><code class="nx">s</code><code class="p">,</code><code> </code><code class="o">&amp;</code><code class="nx">server</code><code class="p">{</code><code class="p">}</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO4-4" id="co_getting_started_with_grpc_CO4-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
&#13;
  </code><code class="nx">log</code><code class="p">.</code><code class="nx">Printf</code><code class="p">(</code><code class="s">"Starting gRPC listener on port "</code><code> </code><code class="o">+</code><code> </code><code class="nx">port</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="k">if</code><code> </code><code class="nx">err</code><code> </code><code class="o">:=</code><code> </code><code class="nx">s</code><code class="p">.</code><code class="nx">Serve</code><code class="p">(</code><code class="nx">lis</code><code class="p">)</code><code class="p">;</code><code> </code><code class="nx">err</code><code> </code><code class="o">!=</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO4-5" id="co_getting_started_with_grpc_CO4-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
     </code><code class="nx">log</code><code class="p">.</code><code class="nx">Fatalf</code><code class="p">(</code><code class="s">"failed to serve: %v"</code><code class="p">,</code><code> </code><code class="nx">err</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code class="p">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO4-1" id="callout_getting_started_with_grpc_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Import the package that contains the generated code we just created from the protobuf compiler.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO4-2" id="callout_getting_started_with_grpc_CO4-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>TCP listener that we want the gRPC server to bind to is created on the port (50051).</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO4-3" id="callout_getting_started_with_grpc_CO4-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>New gRPC server instance is created by calling gRPC Go APIs.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO4-4" id="callout_getting_started_with_grpc_CO4-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The service implemented earlier is registered to the newly created gRPC server by calling generated APIs.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO4-5" id="callout_getting_started_with_grpc_CO4-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Start listening to the incoming messages on the port (50051).</p></dd>&#13;
</dl>&#13;
&#13;
<p>Now we have completed building a gRPC service for our business use case in the Go language. And also we created a simple server that will expose service methods and accept messages from gRPC clients.</p>&#13;
&#13;
<p>If you prefer using Java for building a service, we can implement the same service using Java. The implementation procedure is quite similar to Go. So, let’s create the same service using the Java language. However, if you are interested in building a client application in Go instead, go directly to <a data-type="xref" href="#dev_grpc_client">“Developing a gRPC Client”</a>.<a data-startref="ix_ch02-asciidoc11" data-type="indexterm" id="idm46536645920904"/><a data-startref="ix_ch02-asciidoc10" data-type="indexterm" id="idm46536645920200"/><a data-startref="ix_ch02-asciidoc9" data-type="indexterm" id="idm46536645919528"/></p>&#13;
</div></section>&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing a gRPC Service with Java" data-type="sect3"><div class="sect3" id="idm46536645918600">&#13;
<h3>Implementing a gRPC Service with Java</h3>&#13;
&#13;
<p><a data-primary="Gradle" data-secondary="implementing a gRPC service with Java" data-type="indexterm" id="ix_ch02-asciidoc12"/><a data-primary="Java" data-secondary="implementing a gRPC service with" data-type="indexterm" id="ix_ch02-asciidoc13"/><a data-primary="service" data-secondary="implementing with Java" data-type="indexterm" id="ix_ch02-asciidoc14"/>When creating a Java gRPC project, the best approach is to use an existing build tool like Gradle, Maven, or Bazel because it manages all dependencies and code generation, etc. In our sample, we will use  Gradle to manage the project and we’ll discuss how to create a Java project using Gradle and how to implement the business logic of all remote methods of the service. Finally, we’ll create a server and register the service to accept client requests.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="Gradle" data-secondary="about" data-type="indexterm" id="idm46536645700280"/>Gradle is a build automation tool that supports multiple languages, including Java, Scala, Android, C/C++, and Groovy, and is closely integrated with development tools like Eclipse and IntelliJ IDEA. You can install Gradle on your machine by following the steps given on the <a href="https://gradle.org/install">official page</a>.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Setting up a Java project" data-type="sect4"><div class="sect4" id="set_up_java">&#13;
<h4>Setting up a Java project</h4>&#13;
&#13;
<p><a data-primary="Java" data-secondary="setting up a project" data-type="indexterm" id="ix_ch02-asciidoc15"/>Let’s first create a Gradle Java project (<code>product-info-service</code>). Once you have then created the project, you will get a project structure like the following:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"> product-info-service&#13;
&#13;
  ├── build.gradle&#13;
  ├ . . .&#13;
  └── src&#13;
      ├── main&#13;
      │   ├── java&#13;
      │   └── resources&#13;
      └── <code class="nb">test</code>&#13;
          ├── java&#13;
          └── resources</pre>&#13;
&#13;
<p>Under the <em>src/main</em> directory, create a <em>proto</em> directory and add our <code>ProductInfo</code> service definition file (<em>.proto</em> file) inside the <em>proto</em> directory.</p>&#13;
&#13;
<p>Next, you need to update the <em>build.gradle</em> file and add dependencies and the protobuf plug-in for Gradle. Update the <em>build.gradle</em> file as shown in <a data-type="xref" href="#EX2-8">Example 2-8</a>.</p>&#13;
<div data-type="example" id="EX2-8">&#13;
<h5><span class="label">Example 2-8. </span>Gradle configuration for gRPC Java project</h5>&#13;
&#13;
<pre data-code-language="groovy" data-type="programlisting"><code class="n">apply</code><code> </code><code class="nl">plugin:</code><code> </code><code class="s1">'java'</code><code>&#13;
</code><code class="n">apply</code><code> </code><code class="nl">plugin:</code><code> </code><code class="s1">'com.google.protobuf'</code><code>&#13;
</code><code>&#13;
</code><code class="n">repositories</code><code> </code><code class="o">{</code><code>&#13;
</code><code>   </code><code class="n">mavenCentral</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="kt">def</code><code> </code><code class="n">grpcVersion</code><code> </code><code class="o">=</code><code> </code><code class="s1">'1.24.1'</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO5-1" id="co_getting_started_with_grpc_CO5-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">dependencies</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO5-2" id="co_getting_started_with_grpc_CO5-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>   </code><code class="n">compile</code><code> </code><code class="s2">"io.grpc:grpc-netty:${grpcVersion}"</code><code>&#13;
</code><code>   </code><code class="n">compile</code><code> </code><code class="s2">"io.grpc:grpc-protobuf:${grpcVersion}"</code><code>&#13;
</code><code>   </code><code class="n">compile</code><code> </code><code class="s2">"io.grpc:grpc-stub:${grpcVersion}"</code><code>&#13;
</code><code>   </code><code class="n">compile</code><code> </code><code class="s1">'com.google.protobuf:protobuf-java:3.9.2'</code><code>&#13;
</code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="n">buildscript</code><code> </code><code class="o">{</code><code>&#13;
</code><code>   </code><code class="n">repositories</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">mavenCentral</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="n">dependencies</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO5-3" id="co_getting_started_with_grpc_CO5-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">classpath</code><code> </code><code class="s1">'com.google.protobuf:protobuf-gradle-plugin:0.8.10'</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="n">protobuf</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO5-4" id="co_getting_started_with_grpc_CO5-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>   </code><code class="n">protoc</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">artifact</code><code> </code><code class="o">=</code><code> </code><code class="s1">'com.google.protobuf:protoc:3.9.2'</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="n">plugins</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">grpc</code><code> </code><code class="o">{</code><code>&#13;
</code><code>           </code><code class="n">artifact</code><code> </code><code class="o">=</code><code> </code><code class="s2">"io.grpc:protoc-gen-grpc-java:${grpcVersion}"</code><code>&#13;
</code><code>       </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="n">generateProtoTasks</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">all</code><code class="o">(</code><code class="o">)</code><code class="o">*</code><code class="o">.</code><code class="na">plugins</code><code> </code><code class="o">{</code><code>&#13;
</code><code>           </code><code class="n">grpc</code><code> </code><code class="o">{</code><code class="o">}</code><code>&#13;
</code><code>       </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="n">sourceSets</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO5-5" id="co_getting_started_with_grpc_CO5-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>   </code><code class="n">main</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">java</code><code> </code><code class="o">{</code><code>&#13;
</code><code>           </code><code class="n">srcDirs</code><code> </code><code class="s1">'build/generated/source/proto/main/grpc'</code><code>&#13;
</code><code>           </code><code class="n">srcDirs</code><code> </code><code class="s1">'build/generated/source/proto/main/java'</code><code>&#13;
</code><code>       </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="n">jar</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO5-6" id="co_getting_started_with_grpc_CO5-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>   </code><code class="n">manifest</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">attributes</code><code> </code><code class="s2">"Main-Class"</code><code class="o">:</code><code> </code><code class="s2">"ecommerce.ProductInfoServer"</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="n">from</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">configurations</code><code class="o">.</code><code class="na">compile</code><code class="o">.</code><code class="na">collect</code><code> </code><code class="o">{</code><code> </code><code class="n">it</code><code class="o">.</code><code class="na">isDirectory</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">?</code><code> </code><code class="n">it</code><code> </code><code class="o">:</code><code> </code><code class="n">zipTree</code><code class="o">(</code><code class="n">it</code><code class="o">)</code><code> </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="n">apply</code><code> </code><code class="nl">plugin:</code><code> </code><code class="s1">'application'</code><code>&#13;
</code><code>&#13;
</code><code class="n">startScripts</code><code class="o">.</code><code class="na">enabled</code><code> </code><code class="o">=</code><code> </code><code class="kc">false</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO5-1" id="callout_getting_started_with_grpc_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>gRPC Java library version used in the Gradle project.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO5-2" id="callout_getting_started_with_grpc_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>External dependencies we need to use in this project.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO5-3" id="callout_getting_started_with_grpc_CO5-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Gradle protobuf plug-in version we are using in the project. Use plug-in version 0.7.5 if your Gradle version is lower than 2.12.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO5-4" id="callout_getting_started_with_grpc_CO5-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>In the protobuf plug-in, we need to specify the protobuf compiler version and protobuf Java executable version.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO5-5" id="callout_getting_started_with_grpc_CO5-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>This is to inform IDEs like IntelliJ IDEA, Eclipse, or NetBeans about the generated code.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO5-6" id="callout_getting_started_with_grpc_CO5-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Configure the main class to use when running the application.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Then run the following command to build the library and generate stub code from the protobuf build plug-in:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code class="nv">$ </code>./gradle build</pre>&#13;
&#13;
<p>Now we have the Java project ready with autogenerated code.<a data-startref="ix_ch02-asciidoc15" data-type="indexterm" id="idm46536645419960"/> Let’s implement the service interface and add business logic to the remote methods.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing business logic" data-type="sect4"><div class="sect4" id="idm46536646149960">&#13;
<h4>Implementing business logic</h4>&#13;
&#13;
<p><a data-primary="business logic" data-secondary="implementing with Java" data-type="indexterm" id="ix_ch02-asciidoc16"/><a data-primary="Java" data-secondary="implementing business logic" data-type="indexterm" id="ix_ch02-asciidoc17"/>To start with, let’s create the Java package (<code>ecommerce</code>) inside the <em>src/main/java</em> source directory and create a Java class (<em>ProductInfoImpl.java</em>) inside the package. Then we’ll implement the remote methods as shown in <a data-type="xref" href="#EX2-9">Example 2-9</a>.</p>&#13;
<div data-type="example" id="EX2-9">&#13;
<h5><span class="label">Example 2-9. </span>gRPC service implementation of <em>ProductInfo</em> service in Java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code><code> </code><code class="n">ecommerce</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">io.grpc.Status</code><code class="o">;</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">io.grpc.StatusException</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">java.util.HashMap</code><code class="o">;</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">java.util.Map</code><code class="o">;</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">java.util.UUID</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">ProductInfoImpl</code><code> </code><code class="kd">extends</code><code> </code><code class="n">ProductInfoGrpc</code><code class="o">.</code><code class="na">ProductInfoImplBase</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-1" id="co_getting_started_with_grpc_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>   </code><code class="kd">private</code><code> </code><code class="n">Map</code><code> </code><code class="n">productMap</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">HashMap</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code><code> </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">Product</code><code class="o">&gt;</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>   </code><code class="nd">@Override</code><code>&#13;
</code><code>  </code><code class="kd">public</code><code> </code><code class="kt">void</code><code> </code><code class="nf">addProduct</code><code class="o">(</code><code>&#13;
</code><code>       </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">Product</code><code> </code><code class="n">request</code><code class="o">,</code><code>&#13;
</code><code>      </code><code class="n">io</code><code class="o">.</code><code class="na">grpc</code><code class="o">.</code><code class="na">stub</code><code class="o">.</code><code class="na">StreamObserver</code><code>&#13;
</code><code>           </code><code class="o">&lt;</code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">ProductID</code><code class="o">&gt;</code><code> </code><code class="n">responseObserver</code><code> </code><code class="o">)</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-2" id="co_getting_started_with_grpc_CO6-2"><img alt="2" src="assets/2.png"/></a><a class="co" href="#callout_getting_started_with_grpc_CO6-4" id="co_getting_started_with_grpc_CO6-3"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>       </code><code class="n">UUID</code><code> </code><code class="n">uuid</code><code> </code><code class="o">=</code><code> </code><code class="n">UUID</code><code class="o">.</code><code class="na">randomUUID</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">String</code><code> </code><code class="n">randomUUIDString</code><code> </code><code class="o">=</code><code> </code><code class="n">uuid</code><code class="o">.</code><code class="na">toString</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">productMap</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="n">randomUUIDString</code><code class="o">,</code><code> </code><code class="n">request</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">ProductID</code><code> </code><code class="n">id</code><code> </code><code class="o">=</code><code>&#13;
</code><code>           </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">ProductID</code><code class="o">.</code><code class="na">newBuilder</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code>           </code><code class="o">.</code><code class="na">setValue</code><code class="o">(</code><code class="n">randomUUIDString</code><code class="o">)</code><code class="o">.</code><code class="na">build</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">responseObserver</code><code class="o">.</code><code class="na">onNext</code><code class="o">(</code><code class="n">id</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-5" id="co_getting_started_with_grpc_CO6-4"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>       </code><code class="n">responseObserver</code><code class="o">.</code><code class="na">onCompleted</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-6" id="co_getting_started_with_grpc_CO6-5"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>   </code><code class="nd">@Override</code><code>&#13;
</code><code>  </code><code class="kd">public</code><code> </code><code class="kt">void</code><code> </code><code class="nf">getProduct</code><code class="o">(</code><code>&#13;
</code><code>       </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">ProductID</code><code> </code><code class="n">request</code><code class="o">,</code><code>&#13;
</code><code>       </code><code class="n">io</code><code class="o">.</code><code class="na">grpc</code><code class="o">.</code><code class="na">stub</code><code class="o">.</code><code class="na">StreamObserver</code><code>&#13;
</code><code>            </code><code class="o">&lt;</code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">Product</code><code class="o">&gt;</code><code> </code><code class="n">responseObserver</code><code> </code><code class="o">)</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-3" id="co_getting_started_with_grpc_CO6-6"><img alt="3" src="assets/3.png"/></a><a class="co" href="#callout_getting_started_with_grpc_CO6-4" id="co_getting_started_with_grpc_CO6-7"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>       </code><code class="n">String</code><code> </code><code class="n">id</code><code> </code><code class="o">=</code><code> </code><code class="n">request</code><code class="o">.</code><code class="na">getValue</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="k">if</code><code> </code><code class="o">(</code><code class="n">productMap</code><code class="o">.</code><code class="na">containsKey</code><code class="o">(</code><code class="n">id</code><code class="o">)</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>           </code><code class="n">responseObserver</code><code class="o">.</code><code class="na">onNext</code><code class="o">(</code><code>&#13;
</code><code>                </code><code class="o">(</code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">Product</code><code class="o">)</code><code> </code><code class="n">productMap</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">id</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-5" id="co_getting_started_with_grpc_CO6-8"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>           </code><code class="n">responseObserver</code><code class="o">.</code><code class="na">onCompleted</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-6" id="co_getting_started_with_grpc_CO6-9"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>       </code><code class="o">}</code><code> </code><code class="k">else</code><code> </code><code class="o">{</code><code>&#13;
</code><code>           </code><code class="n">responseObserver</code><code class="o">.</code><code class="na">onError</code><code class="o">(</code><code class="k">new</code><code> </code><code class="n">StatusException</code><code class="o">(</code><code class="n">Status</code><code class="o">.</code><code class="na">NOT_FOUND</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO6-7" id="co_getting_started_with_grpc_CO6-10"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code>       </code><code class="o">}</code><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-1" id="callout_getting_started_with_grpc_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Extend the abstract class (<code>ProductInfoGrpc.ProductInfoImplBase</code>) that is generated from the plug-in. This will allow adding business logic to <code>AddProduct</code> and <code>GetProduct</code> methods defined in the service definition.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-2" id="callout_getting_started_with_grpc_CO6-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The <code>AddProduct</code> method takes <code>Product(ProductInfoOuterClass.Product)</code> as a parameter. The <code>Product</code> class is defined in the <code>ProductInfoOuterClass</code> class, which is generated from the service definition.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-6" id="callout_getting_started_with_grpc_CO6-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The <code>GetProduct</code> method takes <code>ProductID(ProductInfoOuterClass.ProductID)</code> as a parameter. The <code>ProductID</code> class is defined in the <code>ProductInfoOuterClass</code> class, which is generated from the service definition.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-3" id="callout_getting_started_with_grpc_CO6-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The <code>responseObserver</code> object is used to send the response back to the client and close the stream.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-4" id="callout_getting_started_with_grpc_CO6-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Send a response back to the client.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-5" id="callout_getting_started_with_grpc_CO6-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>End the client call by closing the stream.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO6-10" id="callout_getting_started_with_grpc_CO6-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>Send an error back to the client.</p></dd>&#13;
</dl>&#13;
&#13;
<p>That’s all you need to do to implement the business logic of the <code>ProductInfo</code> service in Java. Then we can create a simple server that hosts the service and accepts requests from the client.<a data-startref="ix_ch02-asciidoc17" data-type="indexterm" id="idm46536645064584"/><a data-startref="ix_ch02-asciidoc16" data-type="indexterm" id="idm46536645063880"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating a Java server" data-type="sect4"><div class="sect4" id="idm46536645028216">&#13;
<h4>Creating a Java server</h4>&#13;
&#13;
<p><a data-primary="Java" data-secondary="server creation with" data-type="indexterm" id="idm46536645027096"/><a data-primary="server" data-secondary="creating with Java" data-type="indexterm" id="idm46536645026248"/>In order to expose our service to the outside, we need to create a gRPC server instance and register our <code>ProductInfo</code> service to the server. The server will listen on the specified port and dispatch all requests to the relevant service.&#13;
Let’s create a main class (<em>ProductInfoServer.java</em>) inside the package as shown in <a data-type="xref" href="#EX2-10">Example 2-10</a>.</p>&#13;
<div data-type="example" id="EX2-10">&#13;
<h5><span class="label">Example 2-10. </span>gRPC server implementation to host ProductInfo service in Java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code><code> </code><code class="n">ecommerce</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">io.grpc.Server</code><code class="o">;</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">io.grpc.ServerBuilder</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">java.io.IOException</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">ProductInfoServer</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>   </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="kt">void</code><code> </code><code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">args</code><code class="o">)</code><code>&#13;
</code><code>           </code><code class="kd">throws</code><code> </code><code class="n">IOException</code><code class="o">,</code><code> </code><code class="n">InterruptedException</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="kt">int</code><code> </code><code class="n">port</code><code> </code><code class="o">=</code><code> </code><code class="mi">50051</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">Server</code><code> </code><code class="n">server</code><code> </code><code class="o">=</code><code> </code><code class="n">ServerBuilder</code><code class="o">.</code><code class="na">forPort</code><code class="o">(</code><code class="n">port</code><code class="o">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO7-1" id="co_getting_started_with_grpc_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>               </code><code class="o">.</code><code class="na">addService</code><code class="o">(</code><code class="k">new</code><code> </code><code class="n">ProductInfoImpl</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code>&#13;
</code><code>               </code><code class="o">.</code><code class="na">build</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code>               </code><code class="o">.</code><code class="na">start</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Server started, listening on "</code><code> </code><code class="o">+</code><code> </code><code class="n">port</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">Runtime</code><code class="o">.</code><code class="na">getRuntime</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">addShutdownHook</code><code class="o">(</code><code class="k">new</code><code> </code><code class="n">Thread</code><code class="o">(</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">-</code><code class="o">&gt;</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO7-2" id="co_getting_started_with_grpc_CO7-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>           </code><code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Shutting down gRPC server since JVM is "</code><code> </code><code class="o">+</code><code>&#13;
</code><code>                </code><code class="s">"shutting down"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>           </code><code class="k">if</code><code> </code><code class="o">(</code><code class="n">server</code><code> </code><code class="o">!</code><code class="o">=</code><code> </code><code class="kc">null</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>               </code><code class="n">server</code><code class="o">.</code><code class="na">shutdown</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>           </code><code class="o">}</code><code>&#13;
</code><code>           </code><code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="err">“</code><code class="n">Server</code><code> </code><code class="n">shut</code><code> </code><code class="n">down</code><code class="err">"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="o">}</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">server</code><code class="o">.</code><code class="na">awaitTermination</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO7-3" id="co_getting_started_with_grpc_CO7-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO7-1" id="callout_getting_started_with_grpc_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Server instance is created on port 50051. This is the port we want the server to bind to and where it will listen to incoming messages. Our <code>ProductInfo</code> service implementation is added to the server.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO7-2" id="callout_getting_started_with_grpc_CO7-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>A runtime shutdown hook is added to shut down the gRPC server when JVM shuts down.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO7-3" id="callout_getting_started_with_grpc_CO7-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>At the end of the method, the server thread is held until the server gets <span class="keep-together">terminated.</span></p></dd>&#13;
</dl>&#13;
&#13;
<p>Now we are done with the implementation of the gRPC service in both languages. We can then proceed to the implementation of the gRPC client.<a data-startref="ix_ch02-asciidoc14" data-type="indexterm" id="idm46536644801720"/><a data-startref="ix_ch02-asciidoc13" data-type="indexterm" id="idm46536644801128"/></p>&#13;
</div></section>&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Developing a gRPC Client" data-type="sect2"><div class="sect2" id="dev_grpc_client">&#13;
<h2>Developing a gRPC Client</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="developing a client" data-type="indexterm" id="ix_ch02-asciidoc18"/><a data-primary="client" data-secondary="developing for online retail system application" data-type="indexterm" id="ix_ch02-asciidoc19"/>As we did with the gRPC service implementation, we can now discuss how to create an application to talk with the server. Let’s start off with the generation of the client-side stubs from the service definition. On top of the generated client stub, we can create a simple gRPC client to connect with our gRPC server and invoke the remote methods that it offers.</p>&#13;
&#13;
<p>In this sample, we are going to write client applications in both the Java and Go languages. But you don’t need to create your server and client in the same language, or run them on the same platform. Since gRPC works across languages and platforms, you can create them in any supported language.&#13;
Let’s discuss the Go implementation first. If you are interested in the Java implementation, you may skip the next section and go directly into the Java client.<a data-startref="ix_ch02-asciidoc19" data-type="indexterm" id="idm46536644790632"/><a data-startref="ix_ch02-asciidoc18" data-type="indexterm" id="idm46536644789960"/><a data-startref="ix_ch02-asciidoc12" data-type="indexterm" id="idm46536644789288"/></p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing a gRPC Go client" data-type="sect3"><div class="sect3" id="idm46536644788488">&#13;
<h3>Implementing a gRPC Go client</h3>&#13;
&#13;
<p><a data-primary="client" data-secondary="implementing with Go" data-type="indexterm" id="ix_ch02-asciidoc20"/><a data-primary="Go" data-secondary="client implementation with" data-type="indexterm" id="ix_ch02-asciidoc21"/>Let’s start by creating a new Go module (<code>productinfo/client</code>) and subdirectory (<em>ecommerce</em>) inside the module. In order to implement the Go client application, we also need to generate the stub as we have done when implementing the Go service. Since we need to create the same file (<em>product_info.pb.go</em>) and need to follow the same steps to generate the stubs, we are not going to mention it here. Please refer to <a data-type="xref" href="#gen_client_server_stubs">“Generating client/server stubs”</a> to generate stub files.</p>&#13;
&#13;
<p>Let’s create a new Go file named <em>productinfo_client.go</em> inside the Go module (<code>productinfo/client</code>) and implement the main method to invoke remote methods as shown in <a data-type="xref" href="#EX2-11">Example 2-11</a>.</p>&#13;
<div data-type="example" id="EX2-11">&#13;
<h5><span class="label">Example 2-11. </span>gRPC client application in Go</h5>&#13;
&#13;
<pre data-code-language="go" data-type="programlisting"><code class="kn">package</code><code> </code><code class="nx">main</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="p">(</code><code>&#13;
</code><code>  </code><code class="s">"context"</code><code>&#13;
</code><code>  </code><code class="s">"log"</code><code>&#13;
</code><code>  </code><code class="s">"time"</code><code>&#13;
</code><code>&#13;
</code><code>  </code><code class="nx">pb</code><code> </code><code class="s">"productinfo/client/ecommerce"</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO8-1" id="co_getting_started_with_grpc_CO8-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
  </code><code class="s">"google.golang.org/grpc"</code><code>&#13;
</code><code>&#13;
</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="kd">const</code><code> </code><code class="p">(</code><code>&#13;
</code><code>  </code><code class="nx">address</code><code> </code><code class="p">=</code><code> </code><code class="s">"localhost:50051"</code><code>&#13;
</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="kd">func</code><code> </code><code class="nx">main</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>&#13;
</code><code>&#13;
</code><code>  </code><code class="nx">conn</code><code class="p">,</code><code> </code><code class="nx">err</code><code> </code><code class="o">:=</code><code> </code><code class="nx">grpc</code><code class="p">.</code><code class="nx">Dial</code><code class="p">(</code><code class="nx">address</code><code class="p">,</code><code> </code><code class="nx">grpc</code><code class="p">.</code><code class="nx">WithInsecure</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO8-2" id="co_getting_started_with_grpc_CO8-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
  </code><code class="k">if</code><code> </code><code class="nx">err</code><code> </code><code class="o">!=</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code>&#13;
</code><code>     </code><code class="nx">log</code><code class="p">.</code><code class="nx">Fatalf</code><code class="p">(</code><code class="s">"did not connect: %v"</code><code class="p">,</code><code> </code><code class="nx">err</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="k">defer</code><code> </code><code class="nx">conn</code><code class="p">.</code><code class="nx">Close</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO8-7" id="co_getting_started_with_grpc_CO8-3"><img alt="7" src="assets/7.png"/></a><code>&#13;
  </code><code class="nx">c</code><code> </code><code class="o">:=</code><code> </code><code class="nx">pb</code><code class="p">.</code><code class="nx">NewProductInfoClient</code><code class="p">(</code><code class="nx">conn</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO8-3" id="co_getting_started_with_grpc_CO8-4"><img alt="3" src="assets/3.png"/></a><code>&#13;
&#13;
  </code><code class="nx">name</code><code> </code><code class="o">:=</code><code> </code><code class="s">"Apple iPhone 11"</code><code>&#13;
</code><code>  </code><code class="nx">description</code><code> </code><code class="o">:=</code><code> </code><code class="s">`Meet Apple iPhone 11. All-new dual-camera system with&#13;
              Ultra Wide and Night mode.`</code><code>&#13;
</code><code>  </code><code class="nx">price</code><code> </code><code class="o">:=</code><code> </code><code class="nb">float32</code><code class="p">(</code><code class="mf">1000.0</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="nx">ctx</code><code class="p">,</code><code> </code><code class="nx">cancel</code><code> </code><code class="o">:=</code><code> </code><code class="nx">context</code><code class="p">.</code><code class="nx">WithTimeout</code><code class="p">(</code><code class="nx">context</code><code class="p">.</code><code class="nx">Background</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="nx">time</code><code class="p">.</code><code class="nx">Second</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO8-4" id="co_getting_started_with_grpc_CO8-5"><img alt="4" src="assets/4.png"/></a><code>&#13;
  </code><code class="k">defer</code><code> </code><code class="nx">cancel</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="nx">r</code><code class="p">,</code><code> </code><code class="nx">err</code><code> </code><code class="o">:=</code><code> </code><code class="nx">c</code><code class="p">.</code><code class="nx">AddProduct</code><code class="p">(</code><code class="nx">ctx</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="o">&amp;</code><code class="nx">pb</code><code class="p">.</code><code class="nx">Product</code><code class="p">{</code><code class="nx">Name</code><code class="p">:</code><code> </code><code class="nx">name</code><code class="p">,</code><code> </code><code class="nx">Description</code><code class="p">:</code><code> </code><code class="nx">description</code><code class="p">,</code><code> </code><code class="nx">Price</code><code class="p">:</code><code> </code><code class="nx">price</code><code class="p">}</code><code class="p">)</code><code>  </code><a class="co" href="#callout_getting_started_with_grpc_CO8-5" id="co_getting_started_with_grpc_CO8-6"><img alt="5" src="assets/5.png"/></a><code>&#13;
  </code><code class="k">if</code><code> </code><code class="nx">err</code><code> </code><code class="o">!=</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code>&#13;
</code><code>     </code><code class="nx">log</code><code class="p">.</code><code class="nx">Fatalf</code><code class="p">(</code><code class="s">"Could not add product: %v"</code><code class="p">,</code><code> </code><code class="nx">err</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="nx">log</code><code class="p">.</code><code class="nx">Printf</code><code class="p">(</code><code class="s">"Product ID: %s added successfully"</code><code class="p">,</code><code> </code><code class="nx">r</code><code class="p">.</code><code class="nx">Value</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code>  </code><code class="nx">product</code><code class="p">,</code><code> </code><code class="nx">err</code><code> </code><code class="o">:=</code><code> </code><code class="nx">c</code><code class="p">.</code><code class="nx">GetProduct</code><code class="p">(</code><code class="nx">ctx</code><code class="p">,</code><code> </code><code class="o">&amp;</code><code class="nx">pb</code><code class="p">.</code><code class="nx">ProductID</code><code class="p">{</code><code class="nx">Value</code><code class="p">:</code><code> </code><code class="nx">r</code><code class="p">.</code><code class="nx">Value</code><code class="p">}</code><code class="p">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO8-6" id="co_getting_started_with_grpc_CO8-7"><img alt="6" src="assets/6.png"/></a><code>&#13;
  </code><code class="k">if</code><code> </code><code class="nx">err</code><code> </code><code class="o">!=</code><code> </code><code class="kc">nil</code><code> </code><code class="p">{</code><code>&#13;
</code><code>    </code><code class="nx">log</code><code class="p">.</code><code class="nx">Fatalf</code><code class="p">(</code><code class="s">"Could not get product: %v"</code><code class="p">,</code><code> </code><code class="nx">err</code><code class="p">)</code><code>&#13;
</code><code>  </code><code class="p">}</code><code>&#13;
</code><code>  </code><code class="nx">log</code><code class="p">.</code><code class="nx">Printf</code><code class="p">(</code><code class="s">"Product: "</code><code class="p">,</code><code> </code><code class="nx">product</code><code class="p">.</code><code class="nx">String</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="p">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-1" id="callout_getting_started_with_grpc_CO8-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Import the package that contains the generated code we created from the protobuf compiler.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-2" id="callout_getting_started_with_grpc_CO8-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Set up a connection with the server from the provided address (“localhost:50051”). Here we create an unsecured connection between client and server.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-4" id="callout_getting_started_with_grpc_CO8-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Pass the connection and create a stub. This stub instance contains all the remote methods to invoke the server.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-5" id="callout_getting_started_with_grpc_CO8-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Create a <code>Context</code> to pass with the remote call. Here the <code>Context</code> object contains metadata such as the identity of the end user, authorization tokens, and the request’s deadline and it will exist during the lifetime of the request.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-6" id="callout_getting_started_with_grpc_CO8-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Call <code>addProduct</code> method with product details. This returns a product ID if the action completed successfully. Otherwise it returns an error.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-7" id="callout_getting_started_with_grpc_CO8-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Call <code>getProduct</code> with the product ID. This returns product details if the action completed successfully. Otherwise it returns an error.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO8-3" id="callout_getting_started_with_grpc_CO8-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>Close the connection when everything is done.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Now we have completed building the gRPC client in the Go language. Let’s next create a client using the Java language. This is not a mandatory step to follow. If you are also interested in building a gRPC client in Java, you can continue; otherwise, you can skip the next section and go directly to <a data-type="xref" href="#build_run">“Building and Running”</a>.<a data-startref="ix_ch02-asciidoc21" data-type="indexterm" id="idm46536644473560"/><a data-startref="ix_ch02-asciidoc20" data-type="indexterm" id="idm46536644472856"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing a Java client" data-type="sect3"><div class="sect3" id="idm46536644472056">&#13;
<h3>Implementing a Java client</h3>&#13;
&#13;
<p><a data-primary="client" data-secondary="implementation with Java" data-type="indexterm" id="idm46536644470680"/><a data-primary="Gradle" data-secondary="implementing a Java client with" data-type="indexterm" id="idm46536644469736"/><a data-primary="Java" data-secondary="client implementation with" data-type="indexterm" id="idm46536644411064"/>In order to create a Java client application, we also need to set up a Gradle project (<code>product-info-client</code>) and generate classes using the Gradle plug-in as we did when implementing the Java service. Please follow the steps in <a data-type="xref" href="#set_up_java">“Setting up a Java project”</a> to set up a Java client project.</p>&#13;
&#13;
<p>Once you generate the client stub code for your project via the Gradle build tool, let’s create a new class called <code>ProductInfoClient</code> inside the <code>ecommerce</code> package and add the content in <a data-type="xref" href="#EX2-12">Example 2-12</a>.</p>&#13;
<div data-type="example" id="EX2-12">&#13;
<h5><span class="label">Example 2-12. </span>gRPC client application in Java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code><code> </code><code class="n">ecommerce</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">io.grpc.ManagedChannel</code><code class="o">;</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">io.grpc.ManagedChannelBuilder</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">java.util.logging.Logger</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="cm">/**&#13;
* gRPC client sample for productInfo service.&#13;
*/</code><code>&#13;
</code><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">ProductInfoClient</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>   </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="kt">void</code><code> </code><code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">args</code><code class="o">)</code><code> </code><code class="kd">throws</code><code> </code><code class="n">InterruptedException</code><code> </code><code class="o">{</code><code>&#13;
</code><code>       </code><code class="n">ManagedChannel</code><code> </code><code class="n">channel</code><code> </code><code class="o">=</code><code> </code><code class="n">ManagedChannelBuilder</code><code>&#13;
</code><code>           </code><code class="o">.</code><code class="na">forAddress</code><code class="o">(</code><code class="s">"localhost"</code><code class="o">,</code><code> </code><code class="mi">50051</code><code class="o">)</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO9-1" id="co_getting_started_with_grpc_CO9-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>           </code><code class="o">.</code><code class="na">usePlaintext</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code>           </code><code class="o">.</code><code class="na">build</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">ProductInfoGrpc</code><code class="o">.</code><code class="na">ProductInfoBlockingStub</code><code> </code><code class="n">stub</code><code> </code><code class="o">=</code><code>&#13;
</code><code>              </code><code class="n">ProductInfoGrpc</code><code class="o">.</code><code class="na">newBlockingStub</code><code class="o">(</code><code class="n">channel</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO9-2" id="co_getting_started_with_grpc_CO9-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">ProductID</code><code> </code><code class="n">productID</code><code> </code><code class="o">=</code><code> </code><code class="n">stub</code><code class="o">.</code><code class="na">addProduct</code><code class="o">(</code><code>    </code><a class="co" href="#callout_getting_started_with_grpc_CO9-3" id="co_getting_started_with_grpc_CO9-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>               </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">Product</code><code class="o">.</code><code class="na">newBuilder</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="na">setName</code><code class="o">(</code><code class="s">"Apple iPhone 11"</code><code class="o">)</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="na">setDescription</code><code class="o">(</code><code class="s">"Meet Apple iPhone 11. "</code><code> </code><code class="o">+</code><code>&#13;
</code><code>                            </code><code class="n">All</code><code class="o">-</code><code class="k">new</code><code> </code><code class="n">dual</code><code class="o">-</code><code class="n">camera</code><code> </code><code class="n">system</code><code> </code><code class="n">with</code><code> </code><code class="s">" +&#13;
                            "</code><code class="n">Ultra</code><code> </code><code class="n">Wide</code><code> </code><code class="n">and</code><code> </code><code class="n">Night</code><code> </code><code class="n">mode</code><code class="o">.</code><code class="err">"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="na">setPrice</code><code class="o">(</code><code class="mf">1000.0f</code><code class="o">)</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="na">build</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">productID</code><code class="o">.</code><code class="na">getValue</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">ProductInfoOuterClass</code><code class="o">.</code><code class="na">Product</code><code> </code><code class="n">product</code><code> </code><code class="o">=</code><code> </code><code class="n">stub</code><code class="o">.</code><code class="na">getProduct</code><code class="o">(</code><code class="n">productID</code><code class="o">)</code><code class="o">;</code><code>  </code><a class="co" href="#callout_getting_started_with_grpc_CO9-4" id="co_getting_started_with_grpc_CO9-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>       </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">product</code><code class="o">.</code><code class="na">toString</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>       </code><code class="n">channel</code><code class="o">.</code><code class="na">shutdown</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_getting_started_with_grpc_CO9-5" id="co_getting_started_with_grpc_CO9-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>   </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO9-1" id="callout_getting_started_with_grpc_CO9-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Create a gRPC channel specifying the server address and port we want to connect to. Here we are trying to connect to a server running on the same machine and listening on port 50051. We also enable plaintext, which means we are setting up an unsecured connection between client and server.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO9-2" id="callout_getting_started_with_grpc_CO9-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Create the client stub using the newly created channel. We can create two types of stubs. One is the <code>BlockingStub</code>, which waits until it receives a server response. The other one is the <code>NonBlockingStub</code>, which doesn’t wait for server response, but instead registers an observer to receive the response. In this example, we use a <code>BlockingStub</code> to make the client simple.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO9-3" id="callout_getting_started_with_grpc_CO9-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Call <code>addProduct</code> method using the product details. This returns a product ID if the action completed successfully.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO9-4" id="callout_getting_started_with_grpc_CO9-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Call <code>getProduct</code> with the product ID. Returns the product details if the action completed successfully.</p></dd>&#13;
<dt><a class="co" href="#co_getting_started_with_grpc_CO9-5" id="callout_getting_started_with_grpc_CO9-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Close the connection when everything is done so that the network resources that we used in our application are safely returned back after we are finished.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Now we have finished developing the gRPC client. Let’s make the client and server talk to each other<a data-startref="ix_ch02-asciidoc8" data-type="indexterm" id="idm46536644297656"/><a data-startref="ix_ch02-asciidoc7" data-type="indexterm" id="idm46536644296984"/>.<a data-startref="ix_ch02-asciidoc6" data-type="indexterm" id="idm46536644296184"/><a data-startref="ix_ch02-asciidoc5" data-type="indexterm" id="idm46536644276264"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Building and Running" data-type="sect1"><div class="sect1" id="build_run">&#13;
<h1>Building and Running</h1>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="building/running" data-type="indexterm" id="ix_ch02-asciidoc22"/>It’s time to build and run the gRPC server and client applications that we have created. You can deploy and run a gRPC application on your local machine, on a virtual machine, on Docker, or on Kubernetes. In this section, we will discuss how to build and run the gRPC server and client applications on a local machine.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>We will cover how to deploy and run gRPC applications on Docker and Kubernetes environments in <a data-type="xref" href="ch07.html#ch_07">Chapter 7</a>.</p>&#13;
</div>&#13;
&#13;
<p>Let’s run the gRPC server and client applications that we have just developed in your local machine. Since our server and client applications are written in two languages, we are going to build the server application separately.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Building a Go Server" data-type="sect2"><div class="sect2" id="idm46536644318344">&#13;
<h2>Building a Go Server</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="building a Go server" data-type="indexterm" id="idm46536644316904"/><a data-primary="Go" data-secondary="server building with" data-type="indexterm" id="idm46536644311224"/><a data-primary="server" data-secondary="building with Go" data-type="indexterm" id="idm46536644310280"/>When we implement a Go service, the final package structure in the workspace looks like the following:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">└─ productinfo&#13;
           └─ service&#13;
                 ├─ go.mod&#13;
                 ├─ main.go&#13;
                 ├─ productinfo_service.go&#13;
                 └─ ecommerce&#13;
                    └── product_info.pb.go</pre>&#13;
&#13;
<p>We can build our service to generate a service binary (<em>bin/server</em>). In order to build, first go to the Go module root directory location (<em>productinfo/service</em>) and execute the following shell command:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code class="nv">$ </code>go build -i -v -o bin/server</pre>&#13;
&#13;
<p>Once the build is successful, an executable file (<em>bin/server</em>) is created under the <em>bin</em> directory.</p>&#13;
&#13;
<p>Next, let’s set up the Go client!</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Building a Go Client" data-type="sect2"><div class="sect2" id="idm46536644068648">&#13;
<h2>Building a Go Client</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="building a Go client" data-type="indexterm" id="idm46536644323336"/><a data-primary="client" data-secondary="building with Go" data-type="indexterm" id="idm46536644322392"/><a data-primary="Go" data-secondary="client building with" data-type="indexterm" id="idm46536644321448"/>When we implement a Go client, the package structure in the workspace looks like:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">└─ productinfo&#13;
           └─ client&#13;
                ├─ go.mod&#13;
                ├──main.go&#13;
                └─ ecommerce&#13;
                       └── product_info.pb.go</pre>&#13;
&#13;
<p>We can build the client code the same way we built the Go service using the following shell command:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code class="nv">$ </code>go build -i -v -o bin/client</pre>&#13;
&#13;
<p>Once the build is successful, an executable file (<em>bin/client</em>) is created under the <em>bin</em> directory. The next step is to run the files!</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Running a Go Server and Client" data-type="sect2"><div class="sect2" id="idm46536644068312">&#13;
<h2>Running a Go Server and Client</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="running a Go server and client" data-type="indexterm" id="idm46536644315288"/><a data-primary="client" data-secondary="running with Go" data-type="indexterm" id="idm46536644314376"/><a data-primary="Go" data-secondary="running a server and client" data-type="indexterm" id="idm46536644313432"/><a data-primary="server" data-secondary="running with Go" data-type="indexterm" id="idm46536644361176"/>We’ve just built a client and a server. Let’s run them on separate terminals and make them talk to each other:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting">// Running Server&#13;
<code class="nv">$ </code>bin/server&#13;
2019/08/08 10:17:58 Starting gRPC listener on port :50051&#13;
&#13;
// Running Client&#13;
<code class="nv">$ </code>bin/client&#13;
2019/08/08 11:20:01 Product ID: 5d0e7cdc-b9a0-11e9-93a4-6c96cfe0687d&#13;
added successfully&#13;
2019/08/08 11:20:01 Product: id:<code class="s2">"5d0e7cdc-b9a0-11e9-93a4-6c96cfe0687d"</code>&#13;
        name:<code class="s2">"Apple iPhone 11"</code>&#13;
        description:<code class="s2">"Meet Apple iPhone 11. All-new dual-camera system with</code>&#13;
<code class="s2">        Ultra Wide and Night mode."</code>&#13;
        price:1000</pre>&#13;
&#13;
<p>Next we’ll build a Java server.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Building a Java Server" data-type="sect2"><div class="sect2" id="idm46536644093352">&#13;
<h2>Building a Java Server</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="building a Java server" data-type="indexterm" id="idm46536644092280"/><a data-primary="Java" data-secondary="building a server with" data-type="indexterm" id="idm46536644333944"/><a data-primary="server" data-secondary="building with Java" data-type="indexterm" id="idm46536644333000"/>Since we implement the Java service as a Gradle project, we can easily build the project using the following command:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code class="nv">$ </code>gradle build</pre>&#13;
&#13;
<p>Once the build is successful, the executable JAR (<em>server.jar</em>) file is created under the <em>build/libs</em> directory.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Building a Java Client" data-type="sect2"><div class="sect2" id="idm46536644003160">&#13;
<h2>Building a Java Client</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="building a Java client" data-type="indexterm" id="idm46536644002024"/><a data-primary="client" data-secondary="building with Java" data-type="indexterm" id="idm46536643968152"/><a data-primary="Java" data-secondary="building a client with" data-type="indexterm" id="idm46536643967208"/>Just as with a service, we can easily build the project using the following command:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code class="nv">$ </code>gradle build</pre>&#13;
&#13;
<p>Once the build is successful, the executable JAR (<em>client.jar</em>) file is created under the <em>build/libs</em> directory.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Running a Java Server and Client" data-type="sect2"><div class="sect2" id="idm46536643999288">&#13;
<h2>Running a Java Server and Client</h2>&#13;
&#13;
<p><a data-primary="application example (online retail system)" data-secondary="running a Java server and client" data-type="indexterm" id="idm46536643997944"/><a data-primary="Java" data-secondary="running a server and client" data-type="indexterm" id="idm46536643947576"/><a data-primary="server" data-secondary="running with Java" data-type="indexterm" id="idm46536643946616"/>We’ve now built both a client and server in the Java language. Let’s run them:</p>&#13;
&#13;
<pre data-code-language="sh" data-type="programlisting"><code class="nv">$ </code>java -jar build/libs/server.jar&#13;
INFO: Server started, listening on 50051&#13;
&#13;
<code class="nv">$ </code>java -jar build/libs/client.jar&#13;
INFO: Product ID: a143af20-12e6-483e-a28f-15a38b757ea8 added successfully.&#13;
INFO: Product: name: <code class="s2">"Apple iPhone 11"</code>&#13;
description: <code class="s2">"Meet Apple iPhone 11. All-new dual-camera system with</code>&#13;
<code class="s2">Ultra Wide and Night mode."</code>&#13;
price: 1000.0</pre>&#13;
&#13;
<p>Now we have built and run our sample successfully on local machines. Once we successfully run the client and server, the client application first invokes the <code>addProduct</code> method with product details and receives the product identifier of the newly added product as the response. Then it retrieves the newly added product details by calling the <code>getProduct</code> method with the product identifier. As we mentioned earlier in this chapter, we don’t need to write the client in the same language to talk with the server. We can run a gRPC Java server and Go client and it will work without any issue.</p>&#13;
&#13;
<p>That brings us to the end of the chapter!<a data-startref="ix_ch02-asciidoc22" data-type="indexterm" id="idm46536643941864"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="idm46536644274872">&#13;
<h1>Summary</h1>&#13;
&#13;
<p>When you develop a gRPC application, you first define a service interface definition using protocol buffers, a language-agnostic, platform-neutral, extensible mechanism for serializing structured data. Next, you generate server-side and client-side code for the programming language of your choice, which simplifies the server- and client-side logic by providing the low-level communication abstractions. From the server side, you implement the logic of the method that you expose remotely and run a gRPC server that binds the service. On the client side, you connect to the remote gRPC server and invoke the remote method using the generated client-side code.</p>&#13;
&#13;
<p>This chapter is mainly about getting hands-on experience with developing and running gRPC server and client applications. The experience you gain by following the session is quite useful when building a real-world gRPC application because irrespective of which language you are using, you need similar steps to build a gRPC application.<a data-startref="ix_ch02-asciidoc0" data-type="indexterm" id="idm46536643993304"/> So, in the next chapter, we will further extend the concepts and technologies you learned to build real-world use cases.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>