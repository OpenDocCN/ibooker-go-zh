<html><head></head><body><section data-pdf-bookmark="Chapter 7. labeling data: Maps" data-type="chapter" epub:type="chapter" class="preface"><div class="preface" id="labeling_datacolon_maps">
<h1 class="calibre17"><span class="calibre">Chapter 7. </span>labeling data: Maps</h1>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0205-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><a data-primary="labeling data" data-see="maps" data-type="indexterm" id="idm46062712260536" class="calibre10"/><a data-primary="maps" data-type="indexterm" id="idm46062712259224" class="calibre10"/><a data-primary="maps" data-secondary="about" data-type="indexterm" id="idm46062712258424" class="calibre10"/><strong class="calibre8">Throwing things in piles is fine, until you need to find something again.</strong> You’ve already seen how to create lists of values using <em class="calibre9">arrays</em> and <em class="calibre9">slices</em>. You’ve seen how to apply the same operation to <em class="calibre9">every value</em> in an array or slice. But what if you need to work with a <em class="calibre9">particular</em> value? To find it, you’ll have to start at the beginning of the array or slice, and <em class="calibre9">look through Every. Single. Value.</em></p>
<p class="calibre7">What if there were a kind of collection where every value had a label on it? You could quickly find just the value you needed! In this chapter, we’ll look at <strong class="calibre8">maps</strong>, which do just that.</p>
<section data-pdf-bookmark="Counting votes" data-type="sect1" class="preface"><div class="preface" id="counting_votes">
<h1 class="calibre25">Counting votes</h1>
<p class="calibre7">A seat on the Sleepy Creek County School Board is up for grabs this year, and polls have been showing that the election is really close. Now that it’s election night, the candidates are excitedly watching the votes roll in.</p>
<div data-type="note" epub:type="note" class="calibre22"><h6 class="calibre23">Note</h6>
<p class="calibre7">This is another example that debuted in Head First Ruby, in the hashes chapter. Ruby hashes are a lot like Go maps, so this example works great here, too!</p>
</div>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0206-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><strong class="calibre8">Name: Amber Graham<br class="calibre16"/>Occupation: Manager</strong></p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0206-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><strong class="calibre8">Name: Brian Martin<br class="calibre16"/>Occupation: Accountant</strong></p>
<p class="calibre7">There are two candidates on the ballot, Amber Graham and Brian Martin. Voters also have the option to “write in” a candidate’s name (that is, type in a name that doesn’t appear on the ballot). Those won’t be as common as the main candidates, but we can expect a few such names to appear.</p>
<p class="calibre7">The electronic voting machines in use this year record the votes to text files, one vote per line. (Budgets are tight, so the city council chose the cheap voting machine vendor.)</p>
<p class="calibre7">Here’s a file with all the votes for District A:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0206-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">We need to process each line of the file and tally the total number of times each name occurs. The name with the most votes will be our winner!</p>
</div></section>
<section data-pdf-bookmark="Reading names from a file" data-type="sect1" class="preface"><div class="preface" id="reading_names_from_a_file">
<h1 class="calibre25">Reading names from a file</h1>
<p class="calibre7"><a data-primary="file management" data-secondary="reading names from text files" data-type="indexterm" id="idm46062712242232" class="calibre10"/><a data-primary="names" data-secondary="reading from text files" data-type="indexterm" id="idm46062712237000" class="calibre10"/><a data-primary="reading text files" data-secondary="reading names" data-type="indexterm" id="idm46062712235880" class="calibre10"/><a data-primary="text files" data-secondary="reading names from" data-type="indexterm" id="idm46062712234728" class="calibre10"/>Our first order of business is to read the contents of the <em class="calibre9">votes.txt</em> file. The <code class="calibre20">datafile</code> package from previous chapters already has a <code class="calibre20">GetFloats</code> function that reads each line of a file into a slice, but <code class="calibre20">GetFloats</code> can only read <code class="calibre20">float64</code> values. We’re going to need a separate function that can return the file lines as a slice of <code class="calibre20">string</code> values.</p>
<p class="calibre7">So let’s start by creating a <em class="calibre9">strings.go</em> file alongside the <em class="calibre9">floats.go</em> file in the <em class="calibre9">datafile</em> package directory. In that file, we’ll add a <code class="calibre20">GetStrings</code> function. The code in <code class="calibre20">GetStrings</code> will look much like the code in <code class="calibre20">GetFloats</code> (we’ve grayed out the code that’s identical below). But instead of converting each line to a <code class="calibre20">float64</code> value, <code class="calibre20">GetStrings</code> will just add the line directly to the slice we’re returning, as a <code class="calibre20">string</code> value.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0207-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Now let’s create the program that will actually count the votes. We’ll name it <code class="calibre20">count</code>. Within your Go workspace, go into the <em class="calibre9"><a href="http://src/github.com/headfirstgo" class="calibre10">src/github.com/headfirstgo</a></em> directory and create a new directory named <em class="calibre9">count</em>. Then create a file named <em class="calibre9">main.go</em> within the <em class="calibre9">count</em> directory.</p>
<p class="calibre7">Before writing the full program, let’s confirm that our <code class="calibre20">GetStrings</code> function is working. At the top of the <code class="calibre20">main</code> function, we’ll call <code class="calibre20">datafile.GetStrings</code>, passing it <code class="calibre20">"votes.txt"</code> as the name of the file to read from. We’ll store the returned slice of strings in a new variable named <code class="calibre20">lines</code>, and any error in a variable named <code class="calibre20">err</code>. As usual, if <code class="calibre20">err</code> is not <code class="calibre20">nil</code>, we’ll log the error and exit. Otherwise, we’ll simply call <code class="calibre20">fmt.Println</code> to print out the contents of the <code class="calibre20">lines</code> slice.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0208-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">As we’ve done with other programs, you can compile this program (plus any packages it depends on, <code class="calibre20">datafile</code> in this case) by running <code class="calibre20">go install</code> and providing it the package import path. If you used the directory structure shown above, that import path should be <code class="calibre20">github.com/headfirstgo/count</code>.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0208-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">That will save an executable file named <em class="calibre9">count</em> (or <em class="calibre9">count.exe</em> on Windows) in the <em class="calibre9">bin</em> subdirectory of your Go workspace.</p>
<p class="calibre7"><a data-primary="names" data-secondary="counting with slices" data-type="indexterm" id="idm46062712207608" class="calibre10"/><a data-primary="slices" data-secondary="counting names with" data-type="indexterm" id="idm46062712206376" class="calibre10"/>As with the <em class="calibre9">data.txt</em> file in previous chapters, we need to ensure a <em class="calibre9">votes.txt</em> file is saved in the current directory when we run our program. In the <em class="calibre9">bin</em> subdirectory of your Go workspace, save a file with the contents shown at right. In your terminal, use the <code class="calibre20"><strong class="calibre39">cd</strong></code> command to change to that same subdirectory.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0209-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Now you should be able to run the executable by typing <code class="calibre20"><strong class="calibre39">./count</strong></code> (or <code class="calibre20"><strong class="calibre39">count.exe</strong></code> on Windows). It should read every line of <em class="calibre9">votes.txt</em> into a slice of strings, then print that slice out.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0209-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Counting names the hard way, with slices" data-type="sect1" class="preface"><div class="preface" id="counting_names_the_hard_waycomma_with_sl">
<h1 class="calibre25">Counting names the hard way, with slices</h1>
<p class="calibre7">Reading a slice of names from the file didn’t require learning anything new. But now comes the challenge: how do we count the number of times each name occurs? We’ll show you two ways, first with slices, and then with a new data structure, <em class="calibre9">maps</em>.</p>
<p class="calibre7">For our first solution, we’ll create two slices, each with the same number of elements, in a specific order. The first slice would hold the names we found in the file, with each name occurring once. We could call that one <code class="calibre20">names</code>. The second slice, <code class="calibre20">counts</code>, would hold the number of times each name was found in the file. The element <code class="calibre20">counts[0]</code> would hold the count for <code class="calibre20">names[0]</code>, <code class="calibre20">counts[1]</code> would hold the count for <code class="calibre20">names[1]</code>, and so on.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0209-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Let’s update the <code class="calibre20">count</code> program to actually count the number of times each name occurs in the file. We’ll try this plan of using a <code class="calibre20">names</code> slice to hold each unique candidate name, and a corresponding <code class="calibre20">counts</code> slice to track the number of times each name occurs.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0210-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">As always, we can recompile the program with <code class="calibre20">go install</code>. If we run the resulting executable, it will read the <em class="calibre9">votes.txt</em> file and print each name it finds, along with the number of times that name occurs!</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0210-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Let’s take a closer look at how this works...</p>
<p class="calibre7">Our <code class="calibre20">count</code> program uses a loop nested <em class="calibre9">inside</em> another loop to tally the name counts. The outer loop assigns lines of the file to the <code class="calibre20">line</code> variable, one at a time.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0211-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">The <em class="calibre9">inner</em> loop searches each element of the <code class="calibre20">names</code> slice, looking for a name equal to the current line from the file.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0211-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Say someone adds a write-in candidate to their ballot, causing a line from the text file to be loaded with the string <code class="calibre20">"Carlos Diaz"</code>. The program will check the elements of <code class="calibre20">names</code>, one by one, to see if any of them equal <code class="calibre20">"Carlos Diaz"</code>.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0211-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">If none matches, the program will append the string <code class="calibre20">"Carlos Diaz"</code> to the <code class="calibre20">names</code> slice, and a corresponding count of <code class="calibre20">1</code> to the <code class="calibre20">counts</code> slice (because this line represents the first vote for <code class="calibre20">"Carlos Diaz"</code>).</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0211-04.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">But suppose the next line is the string <code class="calibre20">"Brian Martin"</code>. Because that string already exists in the <code class="calibre20">names</code> slice, the program will find it and add <code class="calibre20">1</code> to the corresponding value in <code class="calibre20">counts</code> instead.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0211-05.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Maps" data-type="sect1" class="preface"><div class="preface" id="maps">
<h1 class="calibre25">Maps</h1>
<p class="calibre7"><a data-primary="== comparison operator" data-type="indexterm" id="idm46062712159432" class="calibre10"/><a data-primary="comparison operators" data-type="indexterm" id="idm46062712158376" class="calibre10"/><a data-primary="key/value pairs (maps)" data-type="indexterm" id="idm46062712157576" class="calibre10"/><a data-primary="maps" data-secondary="about" data-type="indexterm" id="idm46062712156712" class="calibre10"/><a data-primary="maps" data-secondary="key/value pairs for" data-type="indexterm" id="idm46062712155640" class="calibre10"/><a data-primary="maps" data-secondary="slices and" data-type="indexterm" id="idm46062712154456" class="calibre10"/><a data-primary="operators" data-secondary="comparison" data-type="indexterm" id="idm46062712153384" class="calibre10"/><a data-primary="slices" data-secondary="maps and" data-type="indexterm" id="idm46062712152248" class="calibre10"/>But here’s the problem with storing the names in slices: for each and every line of the file, you have to search through many (if not all) of the values in the <code class="calibre20">names</code> slice to compare them. That may work okay in a small district like Sleepy Creek County, but in a bigger district with lots of votes, this approach will be way too slow!</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0212-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Putting data in a slice is like stacking it in a big pile; you can get particular items back out, but you’ll have to search through <em class="calibre9">everything</em> to find them.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0212-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><strong class="calibre8">Slice</strong></p>
<p class="calibre7">Go has another way of storing collections of data: <em class="calibre9">maps</em>. A <strong class="calibre8">map</strong> is a collection where each value is accessed via a <em class="calibre9">key</em>. Keys are an easy way to get data back out of your map. It’s like having neatly labeled file folders instead of a messy pile.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0212-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><strong class="calibre8">Map</strong></p>
<p class="calibre7">Whereas arrays and slices can only use <em class="calibre9">integers</em> as indexes, a map can use <em class="calibre9">any</em> type for keys (as long as values of that type can be compared using <code class="calibre20">==</code>). That includes numbers, strings, and more. The values all have to be of the same type, and the keys all have to be of the same type, but the keys don’t have to be the same type as the values.</p>
<p class="calibre7"><a data-primary="indexes" data-secondary="for maps" data-type="indexterm" id="idm46062712139176" class="calibre10"/><a data-primary="make built-in function" data-secondary="maps and" data-type="indexterm" id="idm46062712135608" class="calibre10"/><a data-primary="maps" data-secondary="indexes for" data-type="indexterm" id="idm46062712137320" class="calibre10"/><a data-primary="short variable declaration (:=)" data-secondary="for maps" data-type="indexterm" id="idm46062712134776" class="calibre10"/><a data-primary="square brackets []" data-secondary="maps and" data-type="indexterm" id="idm46062712133672" class="calibre10"/>To declare a variable that holds a map, you type the <code class="calibre20">map</code> keyword, followed by square brackets (<code class="calibre20">[]</code>) containing the key type. Then, following the brackets, provide the value type.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0213-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Just as with slices, declaring a map variable doesn’t automatically create a map; you need to call the <code class="calibre20">make</code> function (the same function you can use to create slices). Instead of a slice type, you can pass <code class="calibre20">make</code> the type of the map you want to create (which should be the same as the type of the variable you’re going to assign it to).</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0213-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">You may find it’s easier to just use a short variable declaration, though:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0213-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">The syntax to assign values to a map and get them back out again looks a lot like the syntax to assign and get values for arrays or slices. But while arrays and slices only let you use integers as element indexes, you can choose almost any type to use for a map’s keys. The <code class="calibre20">ranks</code> map uses <code class="calibre20">string</code> keys:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0213-04.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<blockquote class="calibre37 pcalibre1 pcalibre2">
<p class="calibre38"><strong class="calibre8">Arrays and slices only let you use integer indexes. But you can choose almost any type to use for a map’s keys.</strong></p>
</blockquote>
<p class="calibre7">Here’s another map with strings as keys and strings as values:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0213-05.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Here’s a map with integers as keys and booleans as values:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0213-06.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Map literals" data-type="sect1" class="preface"><div class="preface" id="map_literals">
<h1 class="calibre25">Map literals</h1>
<p class="calibre7"><a data-primary="curly braces {}" data-secondary="maps and" data-type="indexterm" id="idm46062712113080" class="calibre10"/><a data-primary="literals" data-secondary="map" data-type="indexterm" id="idm46062712111592" class="calibre10"/><a data-primary="map literals" data-type="indexterm" id="idm46062712110504" class="calibre10"/>Just as with arrays and slices, if you know keys and values that you want your map to have in advance, you can use a <strong class="calibre8">map literal</strong> to create it. A map literal starts with the map type (in the form <code class="calibre20">map[<em class="calibre43">KeyType</em>]<em class="calibre43">ValueType</em></code>). This is followed by curly braces containing key/value pairs you want the map to start with. For each key/value pair, you include the key, a colon, and then the value. Multiple key/value pairs are separated by commas.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0214-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Here are a couple of the preceding map examples, re-created using map literals:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0214-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">As with slice literals, leaving the curly braces empty creates a map that starts empty.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0214-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar" class="calibre30"><div class="sidebar" id="exercise_11">
<h5 class="calibre31"><span class="calibre"><img alt="image" src="assets/common.png" class="calibre4"/></span> Exercise</h5>
<p class="calibre7">Fill in the blanks in the program below, so it will produce the output shown.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0214-04.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><img alt="image" src="assets/arrow.png" class="calibre4"/> Answers in <a data-type="xref" href="ch07_split_001.html#exercise_solution_11" class="calibre10">“<span class="calibre"><img alt="image" src="assets/common1.png" class="calibre4"/></span> Exercise Solution”</a>.</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="Zero values within maps" data-type="sect1" class="preface"><div class="preface" id="zero_values_within_maps">
<h1 class="calibre25">Zero values within maps</h1>
<p class="calibre7"><a data-primary="maps" data-secondary="nil value for" data-type="indexterm" id="idm46062712092152" class="calibre10"/><a data-primary="maps" data-secondary="zero values for" data-type="indexterm" id="idm46062712090664" class="calibre10"/><a data-primary="nil value" data-secondary="for maps" data-type="indexterm" id="idm46062712089576" class="calibre10"/><a data-primary="zero values" data-secondary="for maps" data-type="indexterm" id="idm46062712088440" class="calibre10"/>As with arrays and slices, if you access a map key that hasn’t been assigned to, you’ll get a zero value back.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0215-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Depending on the value type, the zero value may not actually be <code class="calibre20">0</code>. For maps with a value type of <code class="calibre20">string</code>, for example, the zero value will be an empty string.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0215-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">As with arrays and slices, zero values can make it safe to manipulate a map value even if you haven’t explicitly assigned to it yet.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0215-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="The zero value for a map variable is nil" data-type="sect1" class="preface"><div class="preface" id="the_zero_value_for_a_map_variable_is_nil">
<h1 class="calibre25">The zero value for a map variable is nil</h1>
<p class="calibre7">As with slices, the zero value for the map variable itself is <code class="calibre20">nil</code>. If you declare a <code class="calibre20">map</code> variable, but don’t assign it a value, its value will be <code class="calibre20">nil</code>. That means no map exists to add new keys and values to. If you try, you’ll get a panic:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0215-04.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Before attempting to add keys and values, create a map using <code class="calibre20">make</code> or a map literal, and assign it to your map variable.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0215-05.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="How to tell zero values apart from assigned values" data-type="sect1" class="preface"><div class="preface" id="how_to_tell_zero_values_apart_from_assig">
<div class="calibre24" id="calibre_pb_0"/>
</div></section>
</div></section>

<section data-pdf-bookmark="Chapter 7. labeling data: Maps" data-type="chapter" epub:type="chapter" class="preface">
<div class="preface" id="labeling_datacolon_maps">
<section data-pdf-bookmark="How to tell zero values apart from assigned values" data-type="sect1" class="preface">
<div class="preface" id="how_to_tell_zero_values_apart_from_assig">
<h1 class="calibre25">How to tell zero values apart from assigned values</h1>
<p class="calibre7"><a data-primary="blank identifier (_)" data-secondary="testing for map values with" data-type="indexterm" id="idm46062712069544" class="calibre10"/><a data-primary="maps" data-secondary="assigned values for" data-type="indexterm" id="idm46062712067976" class="calibre10"/>Zero values, although useful, can sometimes make it difficult to tell whether a given key has been assigned the zero value, or if it has never been assigned.</p>
<p class="calibre7">Here’s an example of a program where this could be an issue. This code erroneously reports that the student <code class="calibre20">"Carl"</code> is failing, when in reality he just hasn’t had any grades logged:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0216-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">To address situations like this, accessing a map key optionally returns a second, Boolean value. It will be <code class="calibre20">true</code> if the returned value has actually been assigned to the map, or <code class="calibre20">false</code> if the returned value just represents the default zero value. Most Go developers assign this Boolean value to a variable named <code class="calibre20">ok</code> (because the name is nice and short).</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0216-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<div data-type="note" epub:type="note" class="calibre22"><h6 class="calibre23">Note</h6>
<p class="calibre7">The Go maintainers refer to this as the “comma ok idiom.” We’ll see it again with type assertions in <a data-type="xref" href="ch11_split_000.html#what_can_you_doquestcolon_interfaces" class="calibre10">Chapter 11</a>.</p>
</div>
<p class="calibre7">If you only want to test whether a value is present, you can have the value itself ignored by assigning it to the <code class="calibre20">_</code> blank identifier.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0216-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">The second return value can be used to decide whether you should treat the value you got from the map as an assigned value that just happens to match the zero value for that type, or as an unassigned value.</p>
<p class="calibre7">Here’s an update to our code that tests whether the requested key has actually had a value assigned before it reports a failing grade:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0217-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar" class="calibre30"><div class="sidebar" id="exercise_12">
<h5 class="calibre31"><span class="calibre"><img alt="image" src="assets/common.png" class="calibre4"/></span> Exercise</h5>
<p class="calibre7">Write down what the output of this program snippet would be.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0217-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><img alt="image" src="assets/arrow.png" class="calibre4"/> Answers in <a data-type="xref" href="ch07_split_001.html#exercise_solution_11" class="calibre10">“<span class="calibre"><img alt="image" src="assets/common1.png" class="calibre4"/></span> Exercise Solution”</a>.</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="Removing key/value pairs with the “delete” function" data-type="sect1" class="preface"><div class="preface" id="removing_keysolvalue_pairs_with_the_ldqu">
<h1 class="calibre25">Removing key/value pairs with the “delete” function</h1>
<p class="calibre7"><a data-primary="delete built-in function" data-type="indexterm" id="idm46062712042920" class="calibre10"/><a data-primary="key/value pairs (maps)" data-type="indexterm" id="idm46062712041656" class="calibre10"/><a data-primary="maps" data-secondary="key/value pairs for" data-type="indexterm" id="idm46062712040792" class="calibre10"/>At some point after assigning a value to a key, you may want to remove it from your map. Go provides the built-in <code class="calibre20">delete</code> function for this purpose. Just pass the <code class="calibre20">delete</code> function two things: the map you want to delete a key from, and the key you want deleted. That key and its corresponding value will be removed from the map.</p>
<p class="calibre7">In the code below, we assign values to keys in two different maps, then delete them again. After that, when we try accessing those keys, we get a zero value (which is <code class="calibre20">0</code> for the <code class="calibre20">ranks</code> map, <code class="calibre20">false</code> for the <code class="calibre20">isPrime</code> map). The secondary Boolean value is also <code class="calibre20">false</code> in each case, which means that the key is not present.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0218-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Updating our vote counting program to use maps" data-type="sect1" class="preface"><div class="preface" id="updating_our_vote_counting_program_to_us">
<h1 class="calibre25">Updating our vote counting program to use maps</h1>
<p class="calibre7"><a data-primary="maps" data-secondary="counting names using" data-type="indexterm" id="idm46062712032184" class="calibre10"/><a data-primary="names" data-secondary="counting using maps" data-type="indexterm" id="idm46062712030392" class="calibre10"/>Now that we understand maps a bit better, let’s see if we can use what we’ve learned to simplify our vote counting program.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0219-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Previously, we used a pair of slices, one called <code class="calibre20">names</code> that held candidate names, and one called <code class="calibre20">counts</code> held vote counts for each name. For each name we read from the file, we had to search through the slice of names, one by one, for a match. We then incremented the vote count for that name in the corresponding element of the <code class="calibre20">counts</code> slice.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0219-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Using a map will be much simpler. We can replace the two slices with a single map (which we’ll also call <code class="calibre20">counts</code>). Our map will use candidate names as its keys, and integers (which will hold the vote counts for that name) as its values. Once that’s set up, all we have to do is use each candidate name we read from the file as a map key, and increment the value that key holds.</p>
<p class="calibre7">Here’s some simplified code that creates a map and increments the values for some candidate names directly:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0219-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Our previous program needed separate logic to add new elements to both slices if the name wasn’t found...</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0219-04.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">But we don’t need to do that with a map. If the key we’re accessing doesn’t already exist, we’ll get the zero value back (literally <code class="calibre20">0</code> in this case, since our values are integers). We then increment that value, giving us <code class="calibre20">1</code>, which gets assigned to the map. When we encounter that name again, we’ll get the assigned value, which we can then increment as normal.</p>
<p class="calibre7">Next, let’s try incorporating our <code class="calibre20">counts</code> map into the actual program, so it can tally the votes from the actual file.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0220-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">We’ll be honest; after all that work to learn about maps, the final code looks a little anticlimactic! We replace the two slice declarations with a single map declaration. Next is the code in the loop that processes strings from the file. We replace the original 11 lines of code there with a single line, which increments the count in the map for the current candidate name. And we replace the loop at the end that prints the results with a single line that prints the whole <code class="calibre20">counts</code> map.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0220-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Trust us, though, the code only <em class="calibre9">looks</em> anticlimactic. There are still complex operations going on here. But the map is handling them all for you, which means you don’t have to write as much code!</p>
<p class="calibre7">As before, you can recompile the program using the <code class="calibre20">go install</code> command. When we rerun the executable, the <em class="calibre9">votes.txt</em> file will be loaded and processed. We’ll see the <code class="calibre20">counts</code> map printed, with the number of times each name was encountered in the file.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0220-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Using for...range loops with maps" data-type="sect1" class="preface"><div class="preface" id="using_forhelliprange_loops_with_maps">
<h1 class="calibre25">Using for...range loops with maps</h1>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0221-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><a data-primary="for ... range loops" data-type="indexterm" id="idm46062712001048" class="calibre10"/><a data-primary="key/value pairs (maps)" data-type="indexterm" id="idm46062711999864" class="calibre10"/><a data-primary="loops" data-secondary="for ... range" data-type="indexterm" id="idm46062711999016" class="calibre10"/><a data-primary="maps" data-secondary="for ... range loops" data-type="indexterm" id="idm46062711997832" class="calibre10"/><a data-primary="maps" data-secondary="key/value pairs for" data-type="indexterm" id="idm46062711996696" class="calibre10"/><strong class="calibre8">Name: Kevin Wagner<br class="calibre16"/>Occupation: Election Volunteer</strong></p>
<p class="calibre7">That’s true. A format of one name and one vote count per line would probably be better:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0221-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">To format each key and value from the map as a separate line, we’re going to need to loop through each entry in the map.</p>
<p class="calibre7">The same <code class="calibre20">for</code>...<code class="calibre20">range</code> loop we’ve been using to process array and slice elements works on maps, too. Instead of assigning an integer index to the first variable you provide, however, the current map key will be assigned.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0221-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">The <code class="calibre20">for</code>...<code class="calibre20">range</code> loop makes it easy to loop through a map’s keys and values. Just provide a variable to hold each key, and another to hold the corresponding value, and it will automatically loop through each entry in the map.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0222-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">If you only need to loop through the keys, you can omit the variable that holds the values:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0222-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">And if you only need the values, you can assign the keys to the <code class="calibre20">_</code> blank identifier:</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0222-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">But there’s one potential issue with this example... If you save the preceding example to a file and run it with <code class="calibre20">go run</code>, you’ll find that the map keys and values are printed in a random order. If you run the program multiple times, you’ll get a different order each time.</p>
<div data-type="note" epub:type="note" class="calibre22"><h6 class="calibre23">Note</h6>
<p class="calibre7">(Note: The same is <span class="calibre21">not</span> true of code run via the online Go Playground site. There, the order will still be random, but it will produce the same output each time it’s run.)</p>
</div>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0222-04.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="The for...range loop handles maps in random order!" data-type="sect1" class="preface"><div class="preface" id="the_forhelliprange_loop_handles_maps_in">
<h1 class="calibre25">The for...range loop handles maps in random order!</h1>
<p class="calibre7"><a data-primary="for loops" data-secondary="maps and" data-type="indexterm" id="idm46062711973672" class="calibre10"/><a data-primary="loops" data-secondary="for" data-type="indexterm" id="idm46062711972056" class="calibre10"/><a data-primary="maps" data-secondary="for loops" data-type="indexterm" id="idm46062711970968" class="calibre10"/><a data-primary="maps" data-secondary="random order processing" data-type="indexterm" id="idm46062711969832" class="calibre10"/>The <code class="calibre20">for</code>...<code class="calibre20">range</code> loop processes map keys and values in a random order because a map is an <em class="calibre9">unordered</em> collection of keys and values. When you use a <code class="calibre20">for</code>...<code class="calibre20">range</code> loop with a map, you never know what order you’ll get the map’s contents in! Sometimes that’s fine, but if you need more consistent ordering, you’ll need to write the code for that yourself.</p>
<p class="calibre7">Here’s an update to the previous program that always prints the names in alphabetical order. It does using two separate <code class="calibre20">for</code> loops. The first loops over each key in the map, ignoring the values, and adds them to a slice of strings. Then, the slice is passed to the <code class="calibre20">sort</code> package’s <code class="calibre20">Strings</code> function to sort it alphabetically, in place.</p>
<p class="calibre7">The second <code class="calibre20">for</code> loop doesn’t loop over the map, it loops over the sorted slice of names. (Which, thanks to the preceding code, now contains every key from the map in alphabetical order.) It prints the name and then gets the value that matches that name from the map. It still processes every key and value in the map, but it gets the keys from the sorted slice, not the map itself.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0223-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">If we save the above code and run it, this time the student names are printed in alphabetical order. This will be true no matter how many times we run the program.</p>
<p class="calibre7">If it doesn’t matter what order your map data is processed in, using a <code class="calibre20">for</code>...<code class="calibre20">range</code> loop directly on the map will probably work for you. But if order matters, you may want to consider setting up your own code to handle the processing order.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0223-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Updating our vote counting program with a for...range loop" data-type="sect1" class="preface"><div class="preface" id="updating_our_vote_counting_program_with">
<h1 class="calibre25">Updating our vote counting program with a for...range loop</h1>
<p class="calibre7">There aren’t a lot of candidates in Sleepy Creek County, so we don’t see a need to sort the output by name. We’ll just use a <code class="calibre20">for</code>...<code class="calibre20">range</code> loop to process the keys and values directly from the map.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0224-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">It’s a pretty simple change to make; we just replace the line that prints the entire map with a <code class="calibre20">for</code>...<code class="calibre20">range</code> loop. We’ll assign each key to a <code class="calibre20">name</code> variable, and each value to a <code class="calibre20">count</code> variable. Then we’ll call <code class="calibre20">Printf</code> to print the current candidate name and vote count.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0224-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Another compilation via <code class="calibre20">go install</code>, another run of the executable, and we’ll see our output in its new format. Each candidate name and their vote count is here, neatly formatted on its own line.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0224-03.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></section>
<section data-pdf-bookmark="The vote counting program is complete!" data-type="sect1" class="preface"><div class="preface" id="the_vote_counting_program_is_completeexc">
<h1 class="calibre25">The vote counting program is complete!</h1>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0225-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0225-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">Our vote counting program is complete!</p>
<p class="calibre7">When the only data collections we had available were arrays and slices, we needed a lot of extra code and processing time to look values up. But maps have made the process easy! Anytime you need to be able to find a collection’s values again, you should consider using a map!</p>
</div></section>
<section data-pdf-bookmark="Code Magnets" data-type="sect1" class="preface"><div class="preface" id="code_magnets_5">
<h1 class="calibre25">Code Magnets</h1>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/bag.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7">A Go program that uses a <code class="calibre20">for</code>...<code class="calibre20">range</code> loop to print out the contents of a map is scrambled up on the fridge. Can you reconstruct the code snippets to make a working program that will produce the given output? (It’s okay if the output order differs between runs of the program.)</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0226-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><img alt="image" src="assets/arrow.png" class="calibre4"/> Answers in <a data-type="xref" href="ch07_split_001.html#code_magnets_solution_5" class="calibre10">“Code Magnets Solution”</a>.</p>
</div></section>
<section data-pdf-bookmark="Your Go Toolbox" data-type="sect1" class="preface"><div class="preface" id="your_go_toolbox_7">
<h1 class="calibre25">Your Go Toolbox</h1>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0227-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<p class="calibre7"><strong class="calibre8">That’s it for <a data-type="xref" href="ch07_split_000.html#labeling_datacolon_maps" class="calibre10">Chapter 7</a>! You’ve added maps to your toolbox.</strong></p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0227-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar" class="calibre30"><div class="sidebar" id="bullet_points_7">
<h5 class="calibre31">Bullet Points</h5>
<ul class="list_style_type_none">
<li class="calibre18"><p class="calibre7">When declaring a map variable, you must provide the types for its keys and its values:</p>
<pre data-type="programlisting" class="calibre32">var myMap map[string]int</pre></li>
<li class="calibre18"><p class="calibre7">To create a new map, call the <code class="calibre20">make</code> function with the type of the map you want:</p>
<pre data-type="programlisting" class="calibre32">myMap = make(map[string]int)</pre></li>
<li class="calibre18"><p class="calibre7">To assign a value to a map, provide the key you want to assign it to in square brackets:</p>
<pre data-type="programlisting" class="calibre32">myMap["my key"] = 12</pre></li>
<li class="calibre18"><p class="calibre7">To get a value, you provide the key as well:</p>
<pre data-type="programlisting" class="calibre32">fmt.Println(myMap["my key"])</pre></li>
<li class="calibre18"><p class="calibre7">You can create a map and initialize it with data at the same time using a <strong class="calibre8">map literal</strong>:</p>
<pre data-type="programlisting" class="calibre32">map[string]int{"a": 2, "b": 3}</pre></li>
<li class="calibre18"><p class="calibre7">As with arrays and slices, if you access a map key that hasn’t been assigned a value, you’ll get a zero value back.</p></li>
<li class="calibre18"><p class="calibre7">Getting a value from a map can return a second, optional Boolean value that indicates whether that value was assigned, or if it represents a default zero value:</p>
<pre data-type="programlisting" class="calibre32">value, ok := myMap["c"]</pre></li>
<li class="calibre18"><p class="calibre7">If you only want to test whether a key has had a value assigned, you can ignore the actual value using the <code class="calibre20">_</code> blank identifier:<br class="calibre16"/></p>
<pre data-type="programlisting" class="calibre32">_, ok := myMap["c"]</pre></li>
<li class="calibre18"><p class="calibre7">You can delete keys and their corresponding values from a map using the <code class="calibre20">delete</code> built-in function:</p>
<pre data-type="programlisting" class="calibre32">delete(myMap, "b")</pre></li>
<li class="calibre18"><p class="calibre7">You can use <code class="calibre20">for</code>...<code class="calibre20">range</code> loops with maps, much like you can with arrays or slices. You provide one variable that will be assigned each key in turn, and a second variable that will be assigned each value in turn.</p>
<pre data-type="programlisting" class="calibre32">for key, value := range myMap {
   fmt.Println(key, value)
}</pre>
</li>
</ul>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar" class="calibre30"><div class="sidebar" id="exercise_solution_11">
<h5 class="calibre31"><span class="calibre"><img alt="image" src="assets/common1.png" class="calibre4"/></span> Exercise Solution</h5>
<p class="calibre7">Fill in the blanks in the program below, so it will produce the output shown.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0228-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar" class="calibre30"><div class="sidebar" id="exercise_solution_12">
<h5 class="calibre31"><span class="calibre"><img alt="image" src="assets/common1.png" class="calibre4"/></span> Exercise Solution</h5>
<p class="calibre7">Write down what the output of this program snippet would be.</p>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0228-02.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>
</div></aside>

</div></section>
<section data-pdf-bookmark="Code Magnets Solution" data-type="sect1" class="preface"><div class="preface" id="code_magnets_solution_5">
<h1 class="calibre25">Code Magnets Solution</h1>
<figure class="informal"><div class="figure">
<img alt="image" src="assets/f0229-01.png" class="calibre4"/>
<h6 class="calibre5"/>
</div></figure>

</div></section>
</div></section></body></html>